package magma;

import com.magbel.util.ApplicationHelper;
import java.sql.*;
import java.util.*;

import magma.net.dao.MagmaDBConnection;
import magma.net.manager.FleetHistoryManager;
import magma.net.manager.AssetPaymentManager;
import com.magbel.util.DatetimeFormat;
import java.text.DateFormat;
import java.text.SimpleDateFormat;
import java.util.Date;
import magma.util.Codes;
import magma.net.vao.ComponentViewDetail;
import magma.net.manager.ComponentManager;
/*

 THESE CLASSESS ARE NEEDED TO MAKE PURCHASEORDER METHODS BELOW WORK
//import magma.net.vao.PurchaseOrder;
//import magma.net.vao.PurchaseOrderDeliveryItem;
//import magma.net.vao.PurchaseOrderItem;


*/


//import magma.net.dao.MagmaDBConnection;
//import magma.net.manager.FleetHistoryManager;

//import magma.util.Codes;





/**
 * <p>Title: Magma.net System</p>
 *
 * <p>Description: Fixed Assets Manager</p>
 *
 * <p>Copyright: Copyright (c) 2006. All rights reserved.</p>
 *
 * <p>Company: Magbel Technologies Limited.</p>
 *
 * @author Charles Ayoola Ayodele-Peters.
   @author Modified by Jejelowo .B.Festus
   @author festus.jejelowo@ocular-minds.com

 * @version 1.0
 */
public class AssetRecordsBean extends legend.ConnectionClass {

    private String branch_id = "";
    private String department_id = "";
    private String category_id = "";
    private String depreciation_start_date = null;
    private String depreciation_end_date = null;
    private String posting_date = null;
    private String make = "";
    private String location = "";
    private String maintained_by = "";
    private String authorized_by = "";
    private String supplied_by = "";
    private String reason = "";
    private String asset_id = "";
    private String description = "";
    private String vendor_account = "";
    private String cost_price = "0";
    private String vatable_cost = "0";
    private String vat_amount = "0";
    private String serial_number = "";
    private String engine_number = "";
    private String model = "";
    private String user = "";
    private String depreciation_rate = "100";
    private String residual_value = "0.00";
    private String subject_to_vat = "";
    private String date_of_purchase = null;
    private String registration_no = "";
    private String require_depreciation = "";
    private String who_to_remind = "";
    private String email_1 = "";
    private String email2 = "";
    private String raise_entry = "N";
    private String section = "";
    private String user_id = "1";
    private String state = "";
    private String driver = "";
    private String who_to_remind_2 = "";
    private String spare_1 = "";
    private String spare_2 = "";
    private double accum_dep = 0.0d;
    private String section_id = "";
    private String wh_tax_cb = "N";
    private String wh_tax_amount = "0";
    private String require_redistribution = "";
    private String status = "PENDING";
    private String province = "";
    private String multiple = "N";
    private String warrantyStartDate = "";
    private String noOfMonths = "";
    private String expiryDate = "";
    private String amountPTD;
    private String amountREM;
    private String partPAY="N";
    private String fullyPAID="N";
    private String group_id;
    private MagmaDBConnection dbConnection;
    private String auth_user;
    private String authuser;
    private DatetimeFormat dateFormat;
    java.text.SimpleDateFormat sdf;
    private Codes code;
    private String bar_code="";
    private String sbu_code ="";
    private String lpo ="";
    private String supervisor ="";
    private String deferPay ="N";


    ComponentManager comp;

    public AssetRecordsBean() throws Exception {

        //super();
        try {
            freeResource();
            sdf = new java.text.SimpleDateFormat("dd-MM-yyyy");
            dbConnection = new MagmaDBConnection();
            dateFormat = new DatetimeFormat();
            code = new Codes();
            
            comp = new ComponentManager();
        } catch (Exception ex) {
        }
    }

    /**
     * insertAssetRecord
     *
     * @return boolean
     */
    private boolean rinsertAssetRecord() throws Exception, Throwable {
        asset_id = new legend.AutoIDSetup().getIdentity(branch_id,
                department_id, section_id, category_id);
        Connection con = null;
        PreparedStatement ps = null;
        boolean done = true;
AssetPaymentManager payment = null;
        /*if (require_redistribution.equalsIgnoreCase("Y")) {
            status = "Z";
                 }*/
        if (make == null || make.equals("")) {
            make = "0";
        }
        if (maintained_by == null || maintained_by.equals("")) {
            maintained_by = "0";
        }
        if (supplied_by == null || supplied_by.equals("")) {
            supplied_by = "0";
        }
        if (user == null || user.equals("")) {
            user = "";
        }
        if (location == null || location.equals("")) {
            location = "0";
        }
        if (driver == null || driver.equals("")) {
            driver = "0";
        }
        if (state == null || state.equals("")) {
            state = "0";
        }
        if (department_id == null || department_id.equals("")) {
            department_id = "0";
        }
        if (vat_amount == null || vat_amount.equals("")) {
            vat_amount = "0.0";
        }
        if (vatable_cost == null || vatable_cost.equals("")) {
            vatable_cost = "0.0";
        }
        if (wh_tax_amount == null || wh_tax_amount.equals("")) {
            wh_tax_amount = "0";
        }
        if (branch_id == null || branch_id.equals("")) {
            branch_id = "0";
        }
        if (province == null || province.equals("")) {
            province = "0";
        }
        if (category_id == null || category_id.equals("")) {
            category_id = "0";
        }

        if (residual_value == null || residual_value.equals("")) {
            residual_value = "0";
        }
        if (section_id == null || section_id.equals("")) {
            section_id = "0";
        }

        if (noOfMonths == null || noOfMonths.equals("")) {
            noOfMonths = "0";
        }
        if (warrantyStartDate == null || warrantyStartDate.equals("")) {
            warrantyStartDate = null;
        }
        if (expiryDate == null || expiryDate.equals("")) {
            expiryDate = null;
        }
    //if (supervisor == null || expiryDate.equals("")) {
        //    expiryDate = null;
       // }

/*
if (bar_code == null || bar_code.equals("")) {
            bar_code = null;
        }
*/
  /*      if (sbu_code == null || sbu_code.equals("")) {
            sbu_code=("0");
        }
  */

/*
if (lpo == null || lpo.equals("")) {
            lpo=("0");
        }
*/
        vat_amount = vat_amount.replaceAll(",", "");
        vatable_cost = vatable_cost.replaceAll(",", "");
        wh_tax_amount = wh_tax_amount.replaceAll(",", "");
        residual_value = residual_value.replaceAll(",", "");
        amountPTD = amountPTD.replaceAll(",","");
        String createQuery = "INSERT INTO AM_ASSET         " +
                             "(" +
                             "ASSET_ID, REGISTRATION_NO, BRANCH_ID, DEPT_ID," +
                             "SECTION_ID, CATEGORY_ID, [DESCRIPTION], VENDOR_AC," +
                             "DATE_PURCHASED, DEP_RATE, ASSET_MAKE, ASSET_MODEL," +
                             "ASSET_SERIAL_NO, ASSET_ENGINE_NO, SUPPLIER_NAME," +

                             "ASSET_USER, ASSET_MAINTENANCE, ACCUM_DEP, MONTHLY_DEP," +
                             "COST_PRICE, NBV, DEP_END_DATE, RESIDUAL_VALUE," +
                             "AUTHORIZED_BY, POSTING_DATE, EFFECTIVE_DATE, PURCHASE_REASON," +
                             "USEFUL_LIFE, TOTAL_LIFE, LOCATION, REMAINING_LIFE," +

                             "VATABLE_COST,VAT, WH_TAX, WH_TAX_AMOUNT, REQ_DEPRECIATION," +
                             "REQ_REDISTRIBUTION, SUBJECT_TO_VAT, WHO_TO_REM, EMAIL1," +
                             "WHO_TO_REM_2, EMAIL2, RAISE_ENTRY, DEP_YTD, [SECTION]," +
                             "STATE, DRIVER, SPARE_1, SPARE_2, ASSET_STATUS, [USER_ID]," +
                             "MULTIPLE,PROVINCE,WAR_START_DATE,WAR_MONTH,WAR_EXPIRY_DATE," +
                             "BRANCH_CODE,DEPT_CODE,SECTION_CODE,CATEGORY_CODE,	AMOUNT_PTD," +
                             "AMOUNT_REM,PART_PAY,FULLY_PAID,BAR_CODE,SBU_CODE,LPO,supervisor,defer_pay) " +

                             "VALUES" +
                             "(?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?," +
                             "?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?)";

        /*
         *First Create Asset Records
         * and then determine if it
         * should be made available for fleet.
         */
        if (this.chkidExists(asset_id)) {
            done = false;
            return done;
        }
        try {

            double costPrice = Double.parseDouble(vat_amount) +
                               Double.parseDouble(vatable_cost);

            con = dbConnection.getConnection("fixedasset");
            ps = con.prepareStatement(createQuery);
            ps.setString(1, asset_id);
            ps.setString(2, registration_no);
            ps.setInt(3, Integer.parseInt(branch_id));
            ps.setInt(4, Integer.parseInt(department_id));
            ps.setInt(5, Integer.parseInt(section_id));
            ps.setInt(6, Integer.parseInt(category_id));
            ps.setString(7, description);
            ps.setString(8, vendor_account);
            ps.setDate(9, dbConnection.dateConvert(date_of_purchase));
            ps.setString(10, getDepreciationRate(category_id));
            ps.setString(11, make);
            ps.setString(12, model);
            ps.setString(13, serial_number);
            ps.setString(14, engine_number);
            ps.setInt(15, Integer.parseInt(supplied_by));
            ps.setString(16, user);
            ps.setInt(17, Integer.parseInt(maintained_by));
            ps.setInt(18, 0);
            ps.setInt(19, 0);
            ps.setDouble(20, costPrice);
            ps.setDouble(21, costPrice);
            ps.setDate(22, dbConnection.dateConvert(depreciation_end_date));
            ps.setDouble(23, Double.parseDouble(residual_value));
            ps.setString(24, authorized_by);
            ps.setTimestamp(25, dbConnection.getDateTime(new java.util.Date()));
            ps.setDate(26, dbConnection.dateConvert(depreciation_start_date));
            ps.setString(27, reason);
            ps.setString(28, "0");
            ps.setString(29, computeTotalLife(getDepreciationRate(category_id)));
            ps.setInt(30, Integer.parseInt(location));
            ps.setString(31, computeTotalLife(getDepreciationRate(category_id)));
            ps.setDouble(32, Double.parseDouble(vatable_cost));
            ps.setDouble(33, Double.parseDouble(vat_amount));
            ps.setString(34, wh_tax_cb);
            ps.setDouble(35, Double.parseDouble(wh_tax_amount));
            ps.setString(36, require_depreciation);
            ps.setString(37, require_redistribution);
            ps.setString(38, subject_to_vat);
            ps.setString(39, who_to_remind);
            ps.setString(40, email_1);
            ps.setString(41, who_to_remind_2);
            ps.setString(42, email2);
            ps.setString(43, raise_entry);
            ps.setString(44, "0");
            ps.setString(45, section);
            ps.setInt(46, Integer.parseInt(state));
            ps.setInt(47, Integer.parseInt(driver));
            ps.setString(48, spare_1);
            ps.setString(49, spare_2);
            ps.setString(50, status);
            ps.setString(51, user_id);
            ps.setString(52, multiple);
            ps.setString(53, province);
            ps.setDate(54, dbConnection.dateConvert(warrantyStartDate));
            ps.setInt(55, new Integer(noOfMonths).intValue());
            ps.setDate(56, dbConnection.dateConvert(expiryDate));
            ps.setString(57, code.getBranchCode(branch_id));
            ps.setString(58, code.getDeptCode(department_id));
            ps.setString(59, code.getSectionCode(section_id));
            ps.setString(60, code.getCategoryCode(category_id));
            ps.setDouble(61, Double.parseDouble(amountPTD));
            ps.setDouble(62, (costPrice-Double.parseDouble(amountPTD)));
            ps.setString(63, partPAY);
            ps.setString(64, fullyPAID);
            ps.setString(65, bar_code);
            ps.setString(66,sbu_code);
            ps.setString(67, lpo);
            ps.setString(68,getSupervisor());
            ps.setString(69, deferPay);
            ps.execute();
            FleetHistoryManager fm = new FleetHistoryManager();
            if (fm.isRequiredForFleet(asset_id)) {
                /*
                 *Copy asset data to Fleet Master
                 */
                fm.copyAssetDataToFleet(asset_id);
            }

        } catch (Exception ex) {
            done = false;
            System.out.println("WARN:Error creating asset->" + ex);
        } finally {
            dbConnection.closeConnection(con, ps);
        }

        return done;
    }

    /**
     * updateAssetRecord
     *
     * @return boolean
     */
    public boolean updateAssetRecord() throws Exception {

        String query = "update am_asset SET  " +
                       "REGISTRATION_NO=?,DESCRIPTION=?,VENDOR_AC=?," +
                       "DATE_PURCHASED=?,ASSET_MAKE=?,ASSET_MODEL=?," +
                       "ASSET_SERIAL_NO=?,ASSET_ENGINE_NO=?,SUPPLIER_NAME=?," +
                       "ASSET_USER=?,ASSET_MAINTENANCE=?,DEP_END_DATE=?," +

                       "RESIDUAL_VALUE=?,AUTHORIZED_BY=?,POSTING_DATE=?," +
                       "EFFECTIVE_DATE=?,PURCHASE_REASON=?,LOCATION=?," +
                       "WHO_TO_REM = ?,EMAIL1 = ?,WHO_TO_REM_2 = ?," +
                       "EMAIL2 = ?,RAISE_ENTRY = ?,SECTION=?,STATE=?,DRIVER = ?," +

                       "SPARE_1 = ?,SPARE_2 = ?,ASSET_STATUS = ?,PROVINCE=? , " +
                       "DEPT_ID = ?,req_redistribution = ?,Req_Depreciation = ?,  " +
                       "SUBJECT_TO_VAT=?,VATABLE_COST=?,VAT=? ,    " +
                       "wh_tax = ?,wh_tax_amount  = ?,BRANCH_ID  = ?,MULTIPLE = ?,COST_PRICE=?,    " +
                       "BRANCH_CODE=?,DEPT_CODE=?,SECTION_CODE=? ,CATEGORY_CODE=?,WAR_START_DATE=?," +
                       "WAR_MONTH=?,WAR_EXPIRY_DATE=?, BAR_CODE =?,SBU_CODE = ?, LPO = ?, supervisor=?, defer_pay=?    " +
                       "WHERE	ASSET_ID = '" + asset_id + "'";

        Connection con = null;
        PreparedStatement ps = null;
        boolean done = true;
        /*if (require_redistribution.equalsIgnoreCase("Y")) {
            status = "Z";
                 }*/
        if (make == null || make.equals("")) {
            make = "0";
        }
        if (maintained_by == null || maintained_by.equals("")) {
            maintained_by = "0";
        }
        if (location == null || location.equals("")) {
            location = "0";
        }
        if (driver == null || driver.equals("")|| driver.equals("-1")) {
            driver = "0";
        }
        if (state == null || state.equals("")) {
            state = "0";
        }
        if (department_id == null || department_id.equals("")) {
            department_id = "0";
        }
        if (vat_amount == null || vat_amount.equals("")) {
            vat_amount = "0.0";
        }
        if (vatable_cost == null || vatable_cost.equals("")) {
            vatable_cost = "0.0";
        }
        if (wh_tax_amount == null || wh_tax_amount.equals("")) {
            wh_tax_amount = "0";
        }
        if (branch_id == null || branch_id.equals("")) {
            branch_id = "0";
        }
        if (residual_value == null || residual_value.equals("")) {
            residual_value = "0";
        }
        if (section_id == null || section_id.equals("")) {
            section_id = "0";
        }

    
        if (bar_code == null || bar_code.equals("")) {
            bar_code = "0";
        }

        if (sbu_code == null || sbu_code.equals("")) {
            sbu_code = "0";
        }

        if (lpo == null || lpo.equals("")) {
            lpo = "0";
        }

        vat_amount = vat_amount.replaceAll(",", "");
        vatable_cost = vatable_cost.replaceAll(",", "");
        wh_tax_amount = wh_tax_amount.replaceAll(",", "");
        residual_value = residual_value.replaceAll(",", "");

        try {

            double costPrice = Double.parseDouble(vat_amount) +
                               Double.parseDouble(vatable_cost);

            con = dbConnection.getConnection("fixedasset");
            ps = con.prepareStatement(query);
            ps.setString(1, registration_no);
            ps.setString(2, description);
            ps.setString(3, vendor_account);
            ps.setDate(4, dbConnection.dateConvert(date_of_purchase));
            ps.setInt(5, Integer.parseInt(make));
            ps.setString(6, model);
            ps.setString(7, serial_number);
            ps.setString(8, engine_number);
            ps.setString(9, supplied_by);
            ps.setString(10, user);
            ps.setInt(11, Integer.parseInt(maintained_by));
            ps.setDate(12, dbConnection.dateConvert(depreciation_end_date));
            ps.setDouble(13, Double.parseDouble(residual_value));
            ps.setString(14, authorized_by);
            ps.setDate(15, dbConnection.dateConvert(date_of_purchase));
            ps.setDate(16, dbConnection.dateConvert(depreciation_start_date));
            ps.setString(17, reason);
            ps.setInt(18, Integer.parseInt(location));
            ps.setString(19, who_to_remind);
            ps.setString(20, email_1);
            ps.setString(21, who_to_remind_2);
            ps.setString(22, email2);
            ps.setString(23, raise_entry);
            ps.setString(24, section);
            ps.setInt(25, Integer.parseInt(state));
            ps.setInt(26, Integer.parseInt(driver));
            ps.setString(27, spare_1);
            ps.setString(28, spare_2);
            ps.setString(29, status);
            ps.setString(30, province);
            ps.setInt(31, Integer.parseInt(department_id));
            ps.setString(32, require_redistribution);
            ps.setString(33, require_depreciation);
            ps.setString(34, subject_to_vat);
            ps.setDouble(35, Double.parseDouble(vatable_cost));
            ps.setDouble(36, Double.parseDouble(vat_amount));
            ps.setString(37, wh_tax_cb);
            ps.setDouble(38, Double.parseDouble(wh_tax_amount));
            ps.setInt(39, Integer.parseInt(branch_id));
            ps.setString(40, multiple);
            ps.setDouble(41, costPrice);
            ps.setString(42, code.getBranchCode(branch_id));
            ps.setString(43, code.getDeptCode(department_id));
            ps.setString(44, code.getSectionCode(section_id));
            ps.setString(45, code.getCategoryCode(category_id));
            ps.setDate(46, dbConnection.dateConvert(warrantyStartDate));
            ps.setInt(47, Integer.parseInt(noOfMonths));
            ps.setDate(48, dbConnection.dateConvert(expiryDate));
            ps.setString(49, bar_code);
            ps.setString(50,sbu_code);
            ps.setString(51, lpo);
            ps.setString(52,getSupervisor());
            ps.setString(53,deferPay);
            ps.execute();
            
        } catch (Exception ex) {
            done = false;
            System.out.println("WARN:Error updating asset->" + ex);
        } finally {
            dbConnection.closeConnection(con, ps);
        }
        return done;

    }

    /**
     * getAssetRecords
     */
    public void getAssetRecords() throws Exception {

        if (asset_id != "") {
            String query = "SELECT A.ASSET_ID, A.REGISTRATION_NO," +
                           "A.BRANCH_ID, A.DEPT_ID, A.CATEGORY_ID,A.SECTION, A.DESCRIPTION," +
                           "A.VENDOR_AC, A.DATE_PURCHASED," +
                           "A.DEP_RATE, A.ASSET_MAKE, A.ASSET_MODEL, A.ASSET_SERIAL_NO, A.ASSET_ENGINE_NO," +
                           "A.SUPPLIER_NAME, A.ASSET_USER, A.ASSET_MAINTENANCE, A.ACCUM_DEP, A.MONTHLY_DEP," +
                           "A.COST_PRICE, A.NBV,A.STATE,A.DRIVER,A.WH_TAX,A.WH_TAX_AMOUNT," +
                           "DEP_END_DATE, A.RESIDUAL_VALUE, A.AUTHORIZED_BY, A.POSTING_DATE,A.EFFECTIVE_DATE," +
                           "A.PURCHASE_REASON, A.USEFUL_LIFE, A.TOTAL_LIFE, A.LOCATION," +
                           "A.REMAINING_LIFE, A.VATABLE_COST, A.VAT, A.REQ_DEPRECIATION," +
                           "A.SUBJECT_TO_VAT, A.WHO_TO_REM, A.EMAIL1, A.EMAIL2," +
                           "A.RAISE_ENTRY, A.DEP_YTD, A.SECTION_ID, A.ASSET_STATUS," +
                           "A.VENDOR_AC,A.SPARE_1,A.SPARE_2,A.REQ_REDISTRIBUTION,A.DATE_DISPOSED," +
                           "A.[USER_ID], A.WHO_TO_REM_2,A.MULTIPLE,A.WAR_START_DATE,WAR_MONTH,WAR_EXPIRY_DATE," +
                           "AMOUNT_PTD,AMOUNT_REM,PART_PAY,FULLY_PAID, GROUP_ID,A.BAR_CODE,A.SBU_CODE,A.LPO,A.SUPERVISOR,A.defer_pay " +
                           "FROM AM_ASSET A " +
                           "WHERE A.ASSET_ID = '" + asset_id + "'";

            Connection con = null;
            PreparedStatement ps = null;
            ResultSet rs = null;

            try {
                con = dbConnection.getConnection("fixedasset");
                ps = con.prepareStatement(query);
                rs = ps.executeQuery();

                if (rs.next()) {

                    registration_no = rs.getString("REGISTRATION_NO");
                    branch_id = rs.getString("BRANCH_ID");
                    department_id = rs.getString("DEPT_ID");
                    category_id = rs.getString("CATEGORY_ID");
                    depreciation_start_date = dbConnection.formatDate(rs.
                            getDate("EFFECTIVE_DATE"));
                    depreciation_end_date = dbConnection.formatDate(rs.getDate(
                            "DEP_END_DATE"));
                    posting_date = dbConnection.formatDate(rs.getDate(
                            "DATE_PURCHASED"));
                    make = rs.getString("ASSET_MAKE");
                    location = rs.getString("LOCATION");
                    maintained_by = rs.getString("ASSET_MAINTENANCE");
                    accum_dep = rs.getDouble("ACCUM_DEP");
                    authorized_by = rs.getString("AUTHORIZED_BY");
                    supplied_by = rs.getString("SUPPLIER_NAME");
                    reason = rs.getString("PURCHASE_REASON");
                    asset_id = rs.getString("ASSET_ID");
                    description = rs.getString("DESCRIPTION");
                    vendor_account = rs.getString("VENDOR_AC");
                    cost_price = rs.getString("COST_PRICE");
                    vatable_cost = rs.getString("VATABLE_COST");
                    vat_amount = rs.getString("VAT");
                    serial_number = rs.getString("ASSET_SERIAL_NO");
                    model = rs.getString("ASSET_MODEL");
                    user = rs.getString("USER_ID");
                    depreciation_rate = rs.getString("DEP_RATE");
                    residual_value = rs.getString("RESIDUAL_VALUE");
                    require_depreciation = rs.getString("REQ_DEPRECIATION");
                    subject_to_vat = rs.getString("SUBJECT_TO_VAT");
                    date_of_purchase = dbConnection.formatDate(rs.getDate(
                            "DATE_PURCHASED"));
                    who_to_remind = rs.getString("WHO_TO_REM");
                    email_1 = rs.getString("EMAIL1");
                    email2 = rs.getString("EMAIL2");
                    raise_entry = rs.getString("RAISE_ENTRY");
                    section = rs.getString("SECTION_ID");
                    accum_dep = rs.getDouble("ACCUM_DEP");
                    status = rs.getString("ASSET_STATUS");
                    section_id = rs.getString("SECTION");
                    wh_tax_cb = rs.getString("WH_TAX");
                    wh_tax_amount = rs.getString("WH_TAX_AMOUNT");
                    require_redistribution = rs.getString("REQ_REDISTRIBUTION");
                    spare_1 = rs.getString("SPARE_1");
                    spare_2 = rs.getString("SPARE_2");
                    who_to_remind_2 = rs.getString("WHO_TO_REM_2");
                    driver = rs.getString("DRIVER");
                    state = rs.getString("STATE");
                    engine_number = rs.getString("ASSET_ENGINE_NO");
                    multiple = rs.getString("MULTIPLE");
                    posting_date = dbConnection.formatDate(rs.getDate(
                            "POSTING_DATE"));
                    warrantyStartDate = dbConnection.formatDate(rs.getDate(
                            "WAR_START_DATE"));
                    noOfMonths = rs.getString("WAR_MONTH");
                    expiryDate = dbConnection.formatDate(rs.getDate(
                            "WAR_EXPIRY_DATE"));
                    authuser = rs.getString("ASSET_USER");
                    amountPTD =String.valueOf(rs.getDouble("AMOUNT_PTD"));
                    amountREM =String.valueOf(rs.getDouble("AMOUNT_REM"));
                    partPAY = rs.getString("PART_PAY");
                    fullyPAID =rs.getString("FULLY_PAID");
                    group_id =rs.getString("GROUP_ID");
                    bar_code = rs.getString("BAR_CODE");
                    sbu_code = rs.getString("SBU_CODE");
                    lpo = rs.getString("LPO");
                    setSupervisor(rs.getString("SUPERVISOR"));
                    deferPay = rs.getString("defer_pay");

                } else {
                    System.out.print("nothing");
                }

            } catch (Exception ex) {
                System.out.println("WARN: Error fetching all asset ->" + ex);
            } finally {
                dbConnection.closeConnection(con, ps);
            }
        }
    }

    /**
     * createAssetId
     *
     * @return String
     */
    private String createAssetId() {
        String id = "";
        try {
            id = new legend.ConnectionClass().getIdentity().substring(24);
        } catch (Exception er) {
            System.out.println("WARN: Error creating id->" + er);
        }
        return id;
    }

    /**
     * depreciationRate
     *
     * @return String
     */
    private String depreciationRate() {
        return "";
    }

    public void setBranch_id(String branch_id) {
        if (branch_id != null) {
            this.branch_id = branch_id;
        }
    }

    public void setDepartment_id(String department_id) {
        if (department_id != null) {
            this.department_id = department_id;
        }
    }

    public void setCategory_id(String category_id) throws Exception {
        if (category_id != null) {
            this.category_id = category_id;
            depreciation_rate = getDepreciationRate(category_id);
        }
    }

    public void setDepreciation_start_date(String depreciation_start_date) {
        this.depreciation_start_date = depreciation_start_date;
    }

    public void setDepreciation_end_date(String depreciation_end_date) {
        this.depreciation_end_date = depreciation_end_date;
    }

    public void setPosting_date(String posting_date) {
        this.depreciation_end_date = depreciation_end_date;
    }

    public void setMake(String make) {
        if (make != null) {
            this.make = make;
        }
    }

    public void setLocation(String location) {
        if (location != null) {
            this.location = location;
        }
    }

    public void setMaintained_by(String maintained_by) {
        if (maintained_by != null) {
            this.maintained_by = maintained_by;
        }
    }

    public void setAuthorized_by(String authorized_by) {
        if (maintained_by != null) {
            this.authorized_by = authorized_by;
        }
    }

    public void setSupplied_by(String supplied_by) {
        if (supplied_by != null) {
            this.supplied_by = supplied_by;
        }
    }

    public void setReason(String reason) {
        if (reason != null) {
            this.reason = reason;
        }
    }

    public void setAsset_id(String asset_id) {
        if (asset_id != null) {
            this.asset_id = asset_id;
        }
    }

    public void setDescription(String description) {
        if (description != null) {
            this.description = description.replaceAll("'", "");
        }
    }

    public void setVendor_account(String vendor_account) {
        if (vendor_account != null) {
            this.vendor_account = vendor_account;
        }
    }

    public void setCost_price(String cost_price) {
        if (cost_price != null) {
            this.cost_price = cost_price.replaceAll(",", "");
            ;
        }
    }

    public void setVatable_cost(String vatable_cost) {
        if (vatable_cost != null) {
            this.vatable_cost = vatable_cost.replaceAll(",", "");
            ;
        }
    }

    public void setVat_amount(String vat_amount) {
        if (vat_amount != null) {
            this.vat_amount = vat_amount.replaceAll(",", "");
            ;
        }
    }

    public void setSerial_number(String serial_number) {
        if (serial_number != null) {
            this.serial_number = serial_number;
        }
    }

    public void setEngine_number(String engine_number) {
        if (engine_number != null) {
            this.engine_number = engine_number;
        }
    }

    public void setModel(String model) {
        if (model != null) {
            this.model = model;
        }
    }

    public void setUser(String user) {
        if (user != null) {
            this.user = user;
        }
    }

    public void setDepreciation_rate(String depreciation_rate) {
        if (depreciation_rate != null) {
            this.depreciation_rate = depreciation_rate;
        }
    }

    public void setResidual_value(String residual_value) {
        if (residual_value != null) {
            this.residual_value = residual_value;
        }
    }

    public void setSubject_to_vat(String subject_to_vat) {
        if (subject_to_vat != null) {
            this.subject_to_vat = subject_to_vat;
        }
    }

    public void setProvince(String province) {
        if (province != null) {
            this.province = province;
        }
    }

    public void setDate_of_purchase(String date_of_purchase) {
        this.date_of_purchase = date_of_purchase;
    }

    public void setRegistration_no(String registration_no) {
        if (registration_no != null) {
            this.registration_no = registration_no;
        }
    }

    public void setRequire_depreciation(String require_depreciation) {
        if (require_depreciation != null) {
            this.require_depreciation = require_depreciation;
        }
    }

    public void setWho_to_remind(String who_to_remind) {
        if (who_to_remind != null) {
            this.who_to_remind = who_to_remind;
        }
    }

    public void setEmail_1(String email_1) {
        if (email_1 != null) {
            this.email_1 = email_1;
        }
    }

    public void setEmail2(String email2) {
        if (email2 != null) {
            this.email2 = email2;
        }
    }

    public void setRaise_entry(String raise_entry) {
        if (raise_entry != null) {
            this.raise_entry = raise_entry;
        }
    }

    public void setSection(String section) {
        if (section != null) {
            this.section = section;
        }
    }

    public void setUser_id(String user_id) {
        if (user_id != null) {
            this.user_id = user_id;
        }
    }

    public void setState(String state) {
        if (state != null) {
            this.state = state;
        }
    }

    public void setDriver(String driver) {
        if (driver != null) {
            this.driver = driver;
        }
    }

    public void setWho_to_remind_2(String who_to_remind_2) {
        if (who_to_remind_2 != null) {
            this.who_to_remind_2 = who_to_remind_2;
        }
    }

    public void setSpare_1(String spare_1) {
        if (spare_1 != null) {
            this.spare_1 = spare_1;
        }
    }

    public void setSpare_2(String spare_2) {
        if (spare_2 != null) {
            this.spare_2 = spare_2;
        }
    }

    public void setAccum_dep(String accum_dep) {
        if (accum_dep != null) {
            this.accum_dep = Double.parseDouble(accum_dep);
        }
    }

    public void setSection_id(String section_id) {
        if (section_id != null) {
            this.section_id = section_id;
        }
    }

    public void setWh_tax_cb(String wh_tax_cb) {
        if (wh_tax_cb != null) {
            this.wh_tax_cb = wh_tax_cb;
        }
    }

    public void setWh_tax_amount(String wh_tax_amount) {
        if (wh_tax_amount != null) {
            this.wh_tax_amount = wh_tax_amount.replaceAll(",", "");
            ;
        }
    }

    public void setRequire_redistribution(String require_redistribution) {
        if (require_redistribution != null) {
            this.require_redistribution = require_redistribution;
        }
    }

    public void setStatus(String status) {
        if (status != null) {
            this.status = status;
        }
    }

    public void setMultiple(String multiple) {
        if (multiple != null) {
            this.multiple = multiple;
        }
    }

    public void setWarrantyStartDate(String warDate) {
        if (warrantyStartDate != null) {
            this.warrantyStartDate = warDate;
        }
    }

    public void setNoOfMonths(String months) {
        if (noOfMonths != null) {
            this.noOfMonths = months;
        }
    }

    public void setExpiryDate(String expiryDate) {
        if (expiryDate != null) {
            this.expiryDate = expiryDate;
        }
    }

    public void setAuth_user(String auth_user) {
        this.auth_user = auth_user;
    }

    public void setAuthuser(String authuser) {
        this.authuser = authuser;
    }

    public String getBranch_id() {
        return branch_id;
    }

    public String getDepartment_id() {
        return department_id;
    }

    public String getCategory_id() {
        return category_id;
    }

    public String getDepreciation_start_date() {
        return depreciation_start_date;
    }

    public String getDepreciation_end_date() {
        return depreciation_end_date;
    }

    public String getPosting_date() {
        return posting_date;
    }

    public String getMake() {
        return make;
    }

    public String getLocation() {
        return location;
    }

    public String getMaintained_by() {
        return maintained_by;
    }

    public String getAuthorized_by() {
        return authorized_by;
    }

    public String getSupplied_by() {
        return supplied_by;
    }

    public String getReason() {
        return reason;
    }

    public String getAsset_id() {
        return asset_id;
    }

    public String getDescription() {
        return description;
    }

    public String getVendor_account() {
        return vendor_account;
    }

    public String getCost_price() {
        return cost_price;
    }

    public String getVatable_cost() {
        return vatable_cost;
    }

    public String getVat_amount() {
        return vat_amount;
    }

    public String getSerial_number() {
        return serial_number;
    }

    public String getEngine_number() {
        return engine_number;
    }

    public String getModel() {
        return model;
    }

    public String getUser() {
        return user;
    }

    public String getDepreciation_rate() {
        return depreciation_rate;
    }

    public String getResidual_value() {
        return residual_value;
    }

    public String getSubject_to_vat() {
        return subject_to_vat;
    }

    public String getDate_of_purchase() {
        return date_of_purchase;
    }

    public String getRegistration_no() {
        return registration_no;
    }

    public String getRequire_depreciation() {
        return require_depreciation;
    }

    public String getWho_to_remind() {
        return who_to_remind;
    }

    public String getEmail_1() {
        return email_1;
    }

    public String getEmail2() {
        return email2;
    }

    public String getRaise_entry() {
        return raise_entry;
    }

    public String getSection() {
        return section;
    }

    public String getUser_id() {
        return user_id;
    }

    public String getState() {
        return state;
    }

    public String getDriver() {
        return driver;
    }

    public String getWho_to_remind_2() {
        return who_to_remind_2;
    }

    public String getSpare_1() {
        return spare_1;
    }

    public String getSpare_2() {
        return spare_2;
    }


    public double getAccum_dep() {
        return accum_dep;
    }


    public String getSection_id() {
        return section_id;
    }

    public String getWh_tax_cb() {
        return wh_tax_cb;
    }

    public String getWh_tax_amount() {
        return wh_tax_amount;
    }

    public String getRequire_redistribution() {
        return require_redistribution;
    }

    public String getStatus() {
        return status;
    }

    public String getProvince() {
        return province;
    }

    public String getMultiple() {
        return multiple;
    }

    public String getWarrantyStartDate() {
        return warrantyStartDate;
    }

    public String getNoOfMonths() {
        return noOfMonths;
    }

    public String getExpiryDate() {
        return expiryDate;
    }

    public String getAuth_user() {
        return auth_user;
    }

    public String getAuthuser() {
        return authuser;
    }

    public String computeTotalLife(String depRate) {

        String totalLife = "0";
        if (depRate == null || depRate.equals("")) {
            depRate = "0.0";
        }

        double division = 100 / (Double.parseDouble(depRate));
        int intTotal = (int) (division * 12);

        totalLife = Integer.toString(intTotal);

        return totalLife;

    }

    /**
     * isMultipleComponent
     *
     * @param category_id String
     * @return boolean
     */
    public boolean isMultipleComponent(String category_id) {

        Connection con = null;
        PreparedStatement ps = null;
        ResultSet rs = null;

        boolean multipleComponent = false;
        String query = "SELECT COUNT(AM_ID) FROM AM_CT_COMPONENT  " +
                       "WHERE CATEGORY = " + category_id;
        try {
            con = dbConnection.getConnection("fixedasset");
            ps = con.prepareStatement(query);
            rs = ps.executeQuery();

            while (rs.next()) {
                int numRecords = rs.getInt(1);
                if (numRecords > 0) {
                    multipleComponent = true;
                }
            }

        } catch (Exception ex) {
            System.out.println("WARN: Error determining  MultipleComponent->" +
                               ex);
        } finally {
            dbConnection.closeConnection(con, ps);
        }

        return multipleComponent;
    }

    /**
     * isDepreciationReCalculatable
     *
     * @param assetid String
     * @return boolean
     */
    public boolean isDepreciationReCalculatable(String assetid) {

        Connection con = null;
        PreparedStatement ps = null;
        ResultSet rs = null;
        final double ZERO = 0.00d;

        boolean calculatable = false;
        String query = "SELECT ACCUM_DEP FROM AM_ASSET  " +
                       "WHERE ASSET_ID = ?";
        try {
            con = dbConnection.getConnection("fixedasset");
            ps = con.prepareStatement(query);
            ps.setString(1, assetid);
            rs = ps.executeQuery();

            while (rs.next()) {

                double accumDep = rs.getDouble(1);
                if (accumDep > ZERO) {
                    calculatable = true;
                }
            }

        } catch (Exception ex) {
            System.out.println("WARN: Error isDepreciationReCalculatable ->" +
                               ex);
        } finally {
            dbConnection.closeConnection(con, ps);
        }

        return calculatable;
    }

    /**
     * getDepreciationRate
     *
     * @param category_id String
     * @return String
     */
    private String getDepreciationRate(String category_id) throws Exception {

        Connection con = null;
        PreparedStatement ps = null;
        ResultSet rs = null;

        String rate = "0.0";
        String query = "SELECT DEP_RATE FROM AM_AD_CATEGORY " +
                       "WHERE CATEGORY_ID = " + category_id;
        try {
            con = dbConnection.getConnection("fixedasset");
            ps = con.prepareStatement(query);
            rs = ps.executeQuery();
            while (rs.next()) {
                rate = rs.getString(1);
            }

        } catch (Exception ex) {
            System.out.println("WARN: Error fetching DepreciationRate ->" + ex);
        } finally {
            dbConnection.closeConnection(con, ps);
        }

        return rate;
    }

    /**
     * residualValue
     *
     * @return String
     */
    public String findResidualValue() {

        Connection con = null;
        PreparedStatement ps = null;
        ResultSet rs = null;
        String residual = "0.0";

        try {
            con = dbConnection.getConnection("fixedasset");
            ps = con.prepareStatement(
                    "SELECT RESIDUAL_VALUE FROM AM_GB_COMPANY");
            rs = ps.executeQuery();

            while (rs.next()) {
                residual = rs.getString(1);
            }

        } catch (Exception ex) {
            System.out.println("WARN: Error fetching all asset ->" + ex);
        } finally {
            dbConnection.closeConnection(con, ps);
        }
        return residual;
    }


    public static String getDepreciationEndDate(String vals) {
        String endDate = "ERROR";


        String checkDepRate = vals.substring(0, vals.indexOf("-")-3);
      
        System.out.println("the depre rate is ===================== "+ checkDepRate);
       if(checkDepRate != null && Double.parseDouble(checkDepRate)==0){
        try {
        SimpleDateFormat sdf1 = new SimpleDateFormat("dd-MM-yyyy");
Date date = new Date();
   endDate = sdf1.format(date);
//output = sdf.parse(sdf.format(date));
     System.out.println("the pre output is " + sdf1.toPattern());
}
        catch(Exception e){
            e.printStackTrace();
}



       }else{


        if (vals != null) {

            StringTokenizer st1 = new StringTokenizer(vals, ",");
            //if(){

            if (st1.countTokens() == 2) {

                String s1 = st1.nextToken();
                String s2 = st1.nextToken();

                Float rate = Float.parseFloat(s1);
                if (s2 != null) {
                    s2 = s2.replaceAll("/", "-");
                }

                StringTokenizer st2 = new StringTokenizer(s2, "-");
                if (st2.countTokens() == 3) {
                    String day = st2.nextToken();
                    String month = st2.nextToken();
                    String year = st2.nextToken();

                    if ((year.length() == 4) && (day.length() > 0) &&
                        (day.length() < 3) && (month.length() > 0) &&
                        (month.length() < 3)) {
                        Calendar c = new GregorianCalendar(Integer.parseInt(
                                year), Integer.parseInt(month) - 1,
                                Integer.parseInt(day) - 1);

                        int months = (int) (100 / rate * 12);
                        c.add(Calendar.MONTH, months);
                        //c.add(Calendar.DAY_OF_YEAR, -1 * Integer.parseInt(day));

                        int endDay = c.get(Calendar.DAY_OF_MONTH);
                        int endMonth = c.get(Calendar.MONTH) + 1;
                        int endYear = c.get(Calendar.YEAR);

                        endDate = endMonth + "-" + endDay + "-" + endYear;
                    }

                }
            }
        }
       }
        return endDate;
    }

    public boolean chkidExists(String assetid) {
        boolean exists = false;
        Connection con = null;
        PreparedStatement ps = null;
        ResultSet rs = null;
        String SQL = "SELECT * FROM am_asset WHERE asset_id='" + assetid + "'";
        try {
            con = dbConnection.getConnection("fixedasset");
            ps = con.prepareStatement(SQL);
            rs = ps.executeQuery();
            exists = rs.next();

        } catch (Exception ex) {
            System.out.println("WARN: Error isDepreciationReCalculatable ->" +
                               ex);
        } finally {
            dbConnection.closeConnection(con, ps);
        }

        return exists;

    }

    public int insertAssetRecord() throws Exception, Throwable {
        String[] budget = getBudgetInfo();
        double[] bugdetvalues = getBudgetValues();
        int DONE = 0; //everything is oK
        int BUDGETENFORCED = 1; //EF budget = Yes, CF = NO, ERROR_FLAG
        int BUDGETENFORCEDCF = 2; //EF budget = Yes, CF = Yes, ERROR_FLAG
        int ASSETPURCHASEBD = 3; //asset falls into no quarter purchase date older than bugdet
        String Q = getQuarter();
        if(budget[3].equalsIgnoreCase("N")){
			rinsertAssetRecord();
			return DONE;
		}
		else if(budget[3].equalsIgnoreCase("Y")){
        if (!Q.equalsIgnoreCase("NQ")) {
            if (budget[3].equalsIgnoreCase("Y") &&
                budget[4].equalsIgnoreCase("N")) {
                if (chkBudgetAllocation(Q, bugdetvalues, false)) {
                    updateBudget(Q, budget);
                    rinsertAssetRecord();
                    return DONE;
                } else {
                    return BUDGETENFORCED;
                }

            } else if (budget[3].equalsIgnoreCase("Y") &&
                       budget[4].equalsIgnoreCase("Y")) {
                if (chkBudgetAllocation(Q, bugdetvalues, true)) {
                    updateBudget(Q, budget);
                    rinsertAssetRecord();
                    return DONE;
                } else {
                    return BUDGETENFORCEDCF;
                }

            } else {
                rinsertAssetRecord();
                return DONE;
            }
        } else {
            //rinsertAssetRecord();
            return ASSETPURCHASEBD;
        }}
        return 0;
    }

    public String[] getBudgetInfo() {
        String[] result = new String[5];

        String query = " SELECT financial_start_date,financial_no_ofmonths"
                       +
                       ",financial_end_date,enforce_acq_budget,quarterly_surplus_cf"
                       + " FROM am_gb_company";

        Connection con = null;
        PreparedStatement ps = null;
        ResultSet rs = null;
        try {
            con = dbConnection.getConnection("fixedasset");
            ps = con.prepareStatement(query);
            rs = ps.executeQuery();
            while (rs.next()) {
                result[0] = sdf.format(rs.getDate("financial_start_date"));
                result[1] = rs.getString("financial_no_ofmonths");
                result[2] = sdf.format(rs.getDate("financial_end_date"));
                result[3] = rs.getString("enforce_acq_budget");
                result[4] = rs.getString("quarterly_surplus_cf");

            }
        } catch (Exception e) {
            String warning = "WARNING:Error Fetching Company Details" +
                             " ->" + e.getMessage();
            System.out.println(warning);
        } finally {
            dbConnection.closeConnection(con, ps, rs);
        }

        return result;
    }

    public double[] getBudgetValues() {
        double[] result = new double[8];

        String query = " SELECT Q1_ALLOCATION,Q1_ACTUAL,Q2_ALLOCATION"
                       +
                       ",Q2_ACTUAL,Q3_ALLOCATION,Q3_ACTUAL,Q4_ALLOCATION,Q4_ACTUAL"
                       + " FROM AM_ACQUISITION_BUDGET WHERE CATEGORY='" +
                       getCatCode() + "' AND "
                       + " BRANCH_ID='" + branch_id + "'";

        Connection con = null;
        PreparedStatement ps = null;
        ResultSet rs = null;
        try {
            con = dbConnection.getConnection("fixedasset");
            ps = con.prepareStatement(query);
            rs = ps.executeQuery();
            while (rs.next()) {
                result[0] = rs.getDouble("Q1_ALLOCATION");
                result[1] = rs.getDouble("Q1_ACTUAL");
                result[2] = rs.getDouble("Q2_ALLOCATION");
                result[3] = rs.getDouble("Q2_ACTUAL");
                result[4] = rs.getDouble("Q3_ALLOCATION");
                result[5] = rs.getDouble("Q3_ACTUAL");
                result[6] = rs.getDouble("Q4_ALLOCATION");
                result[7] = rs.getDouble("Q4_ACTUAL");
                //result[4] = rs.getDouble("quarterly_surplus_cf");


            }
        } catch (Exception e) {
            String warning = "WARNING:Error Fetching Company Details" +
                             " ->" + e.getMessage();
            System.out.println(warning);
        } finally {
            dbConnection.closeConnection(con, ps, rs);
        }

        return result;
    }

    public String getQuarter() {
        System.out.println("getting quarters");
        String quarter = "NQ";
        String[] budg = getBudgetInfo();
        //System.out.println("fsdate  " + budg[0]);
        ///System.out.println("pdate  " + date_of_purchase);
        double q1 = (double) (Double.parseDouble(budg[1]) / 4);
        int month = (int) dateFormat.getDayDifference(date_of_purchase, budg[0]) /
                    30;
        //System.out.println("pdate  " + date_of_purchase);
        //System.out.println("financial start and pdate diff months " + month);
        boolean btw = dateFormat.isDateBetween(budg[0], budg[2],
                                               date_of_purchase);
        if (btw) {
            if ((double) month <= q1) {
                quarter = "FIRST";
               // System.out.println("1st Quarter");
            } else if ((double) month > q1 && (double) month <= (q1 * 2.0)) {
                quarter = "2ND";
                //System.out.println("2nd Quarter");
            } else if ((double) month > (q1 * 2.0) &&
                       (double) month <= (q1 * 3.0)) {
                quarter = "3RD";
                //System.out.println("3rd Quarter");
            } else if (month > (q1 * 3.0)) {
                quarter = "4TH";
                //System.out.println("4th Quarter");
            }

        }
        //System.out.println("the assets quarter is  " + quarter);
        return quarter;

    }

    public String getCatCode() {

        String query =
                "SELECT CATEGORY_CODE  FROM am_ad_category  " +
                "WHERE category_id = '" + category_id + "' ";
        String catid = "0";
        Connection con = null;
       PreparedStatement ps = null;
       ResultSet rs = null;

        try {
            con = dbConnection.getConnection("fixedasset");
                       ps = con.prepareStatement(query);
            rs = ps.executeQuery();

            while (rs.next()) {

                catid = rs.getString(1);

            }

        } catch (Exception ex) {
            ex.printStackTrace();
        } finally {
            dbConnection.closeConnection(con, ps, rs);
        }

        return catid;

    }

    public boolean chkBudgetAllocation(String quarter, double values[],
                                       boolean cf) {
        boolean allocation = true;
        double result = 0.00;
        if (cf) {
            if (quarter.equalsIgnoreCase("FIRST")) {
                result = values[0] -
                         (values[1] +
                          Double.parseDouble(vatable_cost.replaceAll(",", "")));
            } else if (quarter.equalsIgnoreCase("2ND")) {
                result = (values[0] + values[2]) -
                         (values[1] + values[3] +
                          Double.parseDouble(vatable_cost.replaceAll(",", "")));
            } else if (quarter.equalsIgnoreCase("3RD")) {
                result = (values[0] + values[2] + values[4]) -
                         (values[1] + values[3] + values[5] +
                          Double.parseDouble(vatable_cost.replaceAll(",", "")));
            } else if (quarter.equalsIgnoreCase("4TH")) {
                result = (values[0] + values[2] + values[4] + values[6]) -
                         (values[1] + values[3] + values[5] + values[7] +
                          Double.parseDouble(vatable_cost.replaceAll(",", "")));
            }

        } else {
            if (quarter.equalsIgnoreCase("FIRST")) {
                result = values[0] -
                         (values[1] +
                          Double.parseDouble(vatable_cost.replaceAll(",", "")));
            } else if (quarter.equalsIgnoreCase("2ND")) {
                result = values[2] -
                         (values[3] +
                          Double.parseDouble(vatable_cost.replaceAll(",", "")));
            } else if (quarter.equalsIgnoreCase("3RD")) {
                result = values[4] -
                         (values[5] +
                          Double.parseDouble(vatable_cost.replaceAll(",", "")));
            } else if (quarter.equalsIgnoreCase("4TH")) {
                result = values[6] -
                         (values[7] +
                          Double.parseDouble(vatable_cost.replaceAll(",", "")));
            }

        }

        if (result < 0) {
            allocation = false;
        }
        return allocation;
    }

    public void updateBudget(String quarter, String[] bugdetinfo) {

        String fisdate = "";
        int finomonth = 0;
        String fiedate = "";
        Connection conn = dbConnection.getConnection("fixedasset"); ;
        Statement stmt = null;
        try {
            stmt = conn.createStatement();
            /*System.out.println("pdate  " + date_of_purchase);
            System.out.println(
                    "Commencing update of Aquicisition Budget due to Asset Creation");
            System.out.println(category_id);*/
            String old_category = getCatCode();
            if (quarter.equalsIgnoreCase("FIRST")) {
                String budgetUpdate1 = "UPDATE AM_ACQUISITION_BUDGET "
                                       +
                                       " SET Q1_ACTUAL = (Q1_ACTUAL + " +
                                       vatable_cost.replaceAll(",", "") +
                                       ") WHERE BRANCH_ID='" +
                                       branch_id +
                                       "' AND CATEGORY='" + old_category +
                                       "' AND ACC_START_DATE='" +
                                       dateFormat.dateConvert(bugdetinfo[0])
                                       + "' AND ACC_END_DATE='" +
                                       dateFormat.dateConvert(bugdetinfo[2]) +
                                       "'";
               // System.out.println(budgetUpdate1);
                stmt.executeUpdate(budgetUpdate1);
               // System.out.println("Updated 1st Quarter");
            } else if (quarter.equalsIgnoreCase("2ND")) {
                String budgetUpdate1 = "UPDATE AM_ACQUISITION_BUDGET "
                                       +
                                       " SET Q2_ACTUAL = (Q2_ACTUAL + " +
                                       vatable_cost.replaceAll(",", "") +
                                       ") WHERE BRANCH_ID='" +
                                       branch_id +
                                       "' AND CATEGORY='" + old_category +
                                       "' AND ACC_START_DATE='" +
                                       dateFormat.dateConvert(bugdetinfo[0])
                                       + "' AND ACC_END_DATE='" +
                                       dateFormat.dateConvert(bugdetinfo[2]) +
                                       "'";

                //System.out.println(budgetUpdate1);

                stmt.executeUpdate(budgetUpdate1);
                //System.out.println("Updated 2nd Quarter");
            } else if (quarter.equalsIgnoreCase("3RD")) {
                String budgetUpdate1 = "UPDATE AM_ACQUISITION_BUDGET "
                                       +
                                       " SET Q3_ACTUAL =(Q3_ACTUAL + " +
                                       vatable_cost.replaceAll(",", "") +
                                       ") WHERE BRANCH_ID='" +
                                       branch_id +
                                       "' AND CATEGORY='" + old_category +
                                       "' AND ACC_START_DATE='" +
                                       dateFormat.dateConvert(bugdetinfo[0])
                                       + "' AND ACC_END_DATE='" +
                                       dateFormat.dateConvert(bugdetinfo[2]) +
                                       "'";

                //System.out.println(budgetUpdate1);

                stmt.executeUpdate(budgetUpdate1);

                //System.out.println("Updated 3rd Quarter");
            } else if (quarter.equalsIgnoreCase("4TH")) {
                String budgetUpdate1 = "UPDATE AM_ACQUISITION_BUDGET "
                                       +
                                       " SET Q4_ACTUAL = (Q4_ACTUAL + " +
                                       vatable_cost.replaceAll(",", "") +
                                       ") WHERE BRANCH_ID='" +
                                       branch_id +
                                       "' AND CATEGORY='" + old_category +
                                       "' AND ACC_START_DATE='" +
                                       dateFormat.dateConvert(bugdetinfo[0])
                                       + "' AND ACC_END_DATE='" +
                                       dateFormat.dateConvert(bugdetinfo[2]) +
                                       "'";

                //System.out.println(budgetUpdate1);

                stmt.executeUpdate(budgetUpdate1);

                //System.out.println("Updated 4th Quarter");
            }

        } catch (Exception ex) {
            System.out.println("ERROR_ " + this.getClass().getName() + "---" +
                               ex.getMessage() + "--");
            ex.printStackTrace();
        } finally {
            //freeResource();
            dbConnection.closeConnection(conn, stmt);
        }
        //System.out.println(
               // "Exiting update of Aquicisition Budget due to Asset Creation");
    }

	/**
	 * @return the amountPTD
	 */
	public String getAmountPTD() {
		return amountPTD;
	}

	/**
	 * @param amountPTD the amountPTD to set
	 */
	public void setAmountPTD(String amountPTD) {
		this.amountPTD = amountPTD;
	}

	/**
	 * @return the amountREM
	 */
	public String getAmountREM() {
		return amountREM;
	}

	/**
	 * @param amountREM the amountREM to set
	 */
	public void setAmountREM(String amountREM) {
		this.amountREM = amountREM;
	}

	/**
	 * @return the fullyPAID
	 */
	public String getFullyPAID() {
		return fullyPAID;
	}

	/**
	 * @param fullyPAID the fullyPAID to set
	 */
	public void setFullyPAID(String fullyPAID) {
		if(fullyPAID!=null){
		this.fullyPAID = fullyPAID;}
	}

	/**
	 * @return the partPAY
	 */
	public String getPartPAY() {
		return partPAY;
	}

	/**
	 * @param partPAY the partPAY to set
	 */
	public void setPartPAY(String partPAY) {
		if(partPAY!=null){
		this.partPAY = partPAY;}
	}

	/**
	 * @return the group_id
	 */
	public String getGroup_id() {
		return group_id;
	}

	/**
	 * @param group_id the group_id to set
	 */
	public void setGroup_id(String group_id) {
		this.group_id = group_id;
	}

    /**
     * @return the bar_code
     */
    public String getBar_code() {
        if(bar_code == null){
       bar_code ="";
         }

       return bar_code;
        }

    /**
     * @param bar_code the bar_code to set
     */
    public void setBar_code(String bar_code) {
    if (bar_code != null) {
            this.bar_code = bar_code.replaceAll("'", "");
        }

        //this.bar_code = bar_code;
    }



public String subjectToVat(String id){
String result="";
    Connection con = null;
        PreparedStatement ps = null;
        ResultSet rs = null;

         String query =
                "SELECT Subject_TO_Vat FROM am_asset  " +
                "WHERE asset_id = '" + id + "' ";


        try {
            con = dbConnection.getConnection("fixedasset");
            ps = con.prepareStatement(query);
            rs = ps.executeQuery();
            while (rs.next()) {
                result = rs.getString(1);
            }

        } catch (Exception ex) {
            System.out.println("WARN: Error fetching DepreciationRate ->" + ex);
        } finally {
            dbConnection.closeConnection(con, ps);
        }

        return result;
}



 /*

    public String subjectToVat(String Asset_id)
    {
        String subjectVat;
        String query;
        Connection con;
        PreparedStatement ps;
        subjectVat = "";
        query = (new StringBuilder("SELECT Subject_TO_Vat FROM AM_ASSET where Asset_id='")).append(Asset_id).append("'").toString();
        con = null;
        ps = null;
        //ResultSet rs = null;
        try
        {
            con = dbConnection.getConnection("fixedasset");
            ps = con.prepareStatement(query);
            for(ResultSet rs = ps.executeQuery(); rs.next();)
            {
                subjectVat = rs.getString("Subject_TO_Vat");
            }

        }
        catch(Exception er)
        {
            er.printStackTrace();
           // break MISSING_BLOCK_LABEL_134;
        }finally{
        //break MISSING_BLOCK_LABEL_120;
        //Exception exception;
        //exception;
        dbConnection.closeConnection(con, ps);
        //throw exception;
        dbConnection.closeConnection(con, ps);
        //break MISSING_BLOCK_LABEL_145;
        dbConnection.closeConnection(con, ps);
        }
        return subjectVat;
    }

    */

















public String whTax(String id){
String result="";
    Connection con = null;
        PreparedStatement ps = null;
        ResultSet rs = null;

         String query =
                "SELECT wh_tax FROM am_asset  " +
                "WHERE asset_id = '" + id + "' ";


        try {
            con = dbConnection.getConnection("fixedasset");
            ps = con.prepareStatement(query);
            rs = ps.executeQuery();
            while (rs.next()) {
                result = rs.getString(1);
            }

        } catch (Exception ex) {
            System.out.println("WARN: Error fetching WHTAX ->" + ex);
        } finally {
            dbConnection.closeConnection(con, ps);
        }

        return result;
}


public String checkCategoryCode()
    {
       String result="";
    Connection con = null;
        PreparedStatement ps = null;
        ResultSet rs = null;

         String query =
                "SELECT CATEGORY_CODE FROM am_asset" ;



        try {
            con = dbConnection.getConnection("fixedasset");
            ps = con.prepareStatement(query);
            rs = ps.executeQuery();
            while (rs.next()) {
                result = rs.getString(1);
            }

        } catch (Exception ex) {
            System.out.println("WARN: Error fetching CategoryCode ->" + ex);
        } finally {
            dbConnection.closeConnection(con, ps);
        }

        return result;
    }


public String checkBranchCode()
    {
       String result="";
    Connection con = null;
        PreparedStatement ps = null;
        ResultSet rs = null;

         String query =
                "SELECT BRANCH_CODE FROM am_asset" ;



        try {
            con = dbConnection.getConnection("fixedasset");
            ps = con.prepareStatement(query);
            rs = ps.executeQuery();
            while (rs.next()) {
                result = rs.getString(1);
            }

        } catch (Exception ex) {
            System.out.println("WARN: Error fetching BranchCode ->" + ex);
        } finally {
            dbConnection.closeConnection(con, ps);
        }

        return result;
    }

/*

public String checkAssetLedgerAccount(String category, String branch)
    {
        String assetledgeraccount;
        String query;
        Connection con;
        PreparedStatement ps;
        assetledgeraccount = "";
        System.out.println((new StringBuilder("category ")).append(category).toString());
        System.out.println((new StringBuilder("branch ")).append(branch).toString());
        query = (new StringBuilder(" select c.iso_code, (select accronym from am_ad_ledger_type where series = subst" +
"ring(b.asset_acq_ac,1,1)), d.branch_code, b.asset_acq_ac, c.iso_code +(select ac" +
"cronym from am_ad_ledger_type where series = substring(b.asset_acq_ac,1,1))+ d.b" +
"ranch_code + b.asset_acq_ac asd from am_ad_category a,am_ad_branch d,  AM_GB_CUR" +
"RENCY_CODE c, am_gb_company b where a.currency_id = c.currency_id and a.category" +
"_code = '"
)).append(category).append("'").append(" and d.branch_code = '").append(branch).append("'").toString();
        con = null;
        ps = null;
        ResultSet rs = null;
        try
        {
            con = dbConnection.getConnection("fixedasset");
            ps = con.prepareStatement(query);
            rs = ps.executeQuery();
            if(rs.next())
            {
                assetledgeraccount = rs.getString("asd");
            }
        }
        catch(Exception er)
        {
            er.printStackTrace();
           // break MISSING_BLOCK_LABEL_195;
        }finally{
       // break MISSING_BLOCK_LABEL_181;
        //Exception exception;
        //exception;
        dbConnection.closeConnection(con, ps);
        //throw exception;
        dbConnection.closeConnection(con, ps);
        //break MISSING_BLOCK_LABEL_206;
        dbConnection.closeConnection(con, ps);
        }
        return assetledgeraccount;
    }


public String checkAccounAcqusitionSuspense(String category, String branch)
    {
        String assetAcqusitionSuspense;
        String query;
        Connection con;
        PreparedStatement ps;
        assetAcqusitionSuspense = "";
        System.out.println((new StringBuilder("category ")).append(category).toString());
        System.out.println((new StringBuilder("branch ")).append(branch).toString());
        query = (new StringBuilder(" select c.iso_code, (select accronym from am_ad_ledger_type where series = subst" +
"ring(a.Asset_Ledger,1,1)), d.branch_code, a.Asset_Ledger, c.iso_code +(select ac" +
"cronym from am_ad_ledger_type where series = substring(a.Asset_Ledger,1,1))+ d.b" +
"ranch_code +\ta.Asset_Ledger asd from am_ad_category a,am_ad_branch d, AM_GB_CUR" +
"RENCY_CODE c, am_gb_company b where a.currency_id = c.currency_id and a.category" +
"_code = '"
)).append(category).append("'").append(" and d.branch_code = '").append(branch).append("'").toString();
        con = null;
        ps = null;
        ResultSet rs = null;
        try
        {
            con = dbConnection.getConnection("fixedasset");
            ps = con.prepareStatement(query);
           rs = ps.executeQuery();
            if(rs.next())
            {
                assetAcqusitionSuspense = rs.getString("asd");
            }
        }
        catch(Exception er)
        {
            er.printStackTrace();
            //break MISSING_BLOCK_LABEL_195;
        }finally{
        //break MISSING_BLOCK_LABEL_181;
        //Exception exception;
        //exception;
        dbConnection.closeConnection(con, ps);
        //throw exception;
        dbConnection.closeConnection(con, ps);
        //break MISSING_BLOCK_LABEL_206;
        dbConnection.closeConnection(con, ps);
        }
        return assetAcqusitionSuspense;

    }

*/

/*
public String formatDate(java.util.Date date)
    {
        String formated = "";
        if(date == null)
        {
            date = new java.util.Date();
        }
        try
        {
            SimpleDateFormat sdf = new SimpleDateFormat("dd-MM-yyyy");
            formated = sdf.format(date);
        }
        catch(Exception e)
        {
            System.out.println((new StringBuilder("WARNING:Error formating Date ->")).append(e.getMessage()).toString());
        }
        return formated;
    }
*/



 public String getCodeName(String query)
    {
        String result;
        Connection con;
        PreparedStatement ps;
        result = "";
        con = null;
        //ResultSet rs = null;
        ps = null;
        try
        {
            con = dbConnection.getConnection("fixedasset");
            ps = con.prepareStatement(query);
            for(ResultSet rs = ps.executeQuery(); rs.next();)
            {
                result = rs.getString(1) != null ? rs.getString(1) : "";
            }

        }
        catch(Exception er)
        {
            System.out.println((new StringBuilder("Error in getCodeName()... ->")).append(er).toString());
            er.printStackTrace();
            //break MISSING_BLOCK_LABEL_143;
        }
        finally{
        //break MISSING_BLOCK_LABEL_130;
        //Exception exception;
        //exception;
        dbConnection.closeConnection(con, ps);
        //throw exception;
        dbConnection.closeConnection(con, ps);
        //break MISSING_BLOCK_LABEL_153;
        dbConnection.closeConnection(con, ps);
        }
        return result;
    }


 public boolean createRequisitionForm(String itemRequest, String requestBranch, String requestDepartment, String remark, String requestTo, String approval)
    {
        boolean done;
        String query;
        Connection con;
        PreparedStatement ps;
        ResultSet rs;
        done = false;
        query = "INSERT INTO REQUISITIONFORM VALUES(?,?,?,?,?,?)";
        con = null;
        ps = null;
        rs = null;
        try
        {
            con = dbConnection.getConnection("fixedasset");
            ps = con.prepareStatement(query);
            ps.setString(1, itemRequest);
            ps.setString(2, requestBranch);
            ps.setString(3, requestDepartment);
            ps.setString(4, remark);
            ps.setString(5, requestTo);
            ps.setString(6, approval);
            ps.execute();
            if(rs.next())
            {
                done = true;
            }
        }
        catch(Exception er)
        {
            er.printStackTrace();
           // break MISSING_BLOCK_LABEL_162;
        }finally{
        //break MISSING_BLOCK_LABEL_148;
       // Exception exception;
        //exception;
        dbConnection.closeConnection(con, ps);
        //throw exception;
        dbConnection.closeConnection(con, ps);
        //break MISSING_BLOCK_LABEL_173;
        dbConnection.closeConnection(con, ps);
        }
        return done;
    }

    /**
     * @return the sbu
     */
    public String getSbu_code() {
         if(sbu_code == null){
       sbu_code ="";
         }

       return sbu_code;
    }

    /**
     * @param sbu the sbu to set
     */
    public void setSbu_code(String sbu_code) {
        
        if (sbu_code != null) {
            this.sbu_code = sbu_code;
        }
        //this.sbu = sbu;
    }

    /**
     * @return the lpo
     */
    public String getLpo() {
        if(lpo == null){
       lpo ="";
         }

       return lpo;
    }

    /**
     * @param lpo the lpo to set
     */
    public void setLpo(String lpo) {
         if (lpo != null) {
            this.lpo = lpo;
         }
    }

    public String[] setUpInfo(){

        String[] result= new String[3];
    Connection con = null;
        PreparedStatement ps = null;
        ResultSet rs = null;

         String query =
                "SELECT LPO_Required,Barcode_Fld,Trans_Threshold FROM am_gb_company" ;



        try {
            con = dbConnection.getConnection("fixedasset");
            ps = con.prepareStatement(query);
            rs = ps.executeQuery();
            while (rs.next()) {
                result[0] = rs.getString(1);
                result[1]= rs.getString(2);
                result[2] = rs.getString(3);
            }

        } catch (Exception ex) {
            System.out.println("WARN: Error fetching CategoryCode ->" + ex);
        } finally {
            dbConnection.closeConnection(con, ps);
        }

        return result;


    }

    /**
     * @return the supervisor
     */
    public String getSupervisor() {
        return supervisor;
    }

    /**
     * @param supervisor the supervisor to set
     */
    public void setSupervisor(String supervisor) {
        this.supervisor = supervisor;
    }


    public void setPendingTrans(String[] a, String code){
   
        int transaction_level=0;
        Connection con;
        PreparedStatement ps;
        ResultSet rs;
 String pq = "insert into am_asset_approval(asset_id,user_id,super_id,amount,posting_date,description,effective_date,branchCode,asset_status,tran_type, process_status,tran_sent_time,transaction_id,batch_id,transaction_level) values(?,?,?,?,?,?,?,?,?,?,?,?,?,?,?)";
 String tranLevelQuery = "select level from approval_level_setup where code ='"+code+"'";
        con = null;
        ps = null;
        rs = null;
        try
        {
            con = dbConnection.getConnection("fixedasset");

            
            /////////////To get transaction level
             ps = con.prepareStatement(tranLevelQuery);
              rs = ps.executeQuery();


            while(rs.next()){
            transaction_level = rs.getInt(1);

            }//if



            ////////////To set values for approval table

            ps = con.prepareStatement(pq);

       
            SimpleDateFormat timer = new SimpleDateFormat("kk:mm:ss");

            String mtid =  new ApplicationHelper().getGeneratedId("am_asset_approval");
            ps.setString(1, (a[0]==null)?"":a[0]);
            ps.setString(2, (a[1]==null)?"":a[1]);
            ps.setString(3, (a[2]==null)?"":a[2]);
            ps.setDouble(4, (a[3]==null)?0:Double.parseDouble(a[3]));
            ps.setDate(5, (a[4])==null?null:dbConnection.dateConvert(a[4]));
            ps.setString(6, (a[5]==null)?"":a[5]);
            ps.setDate(7,(a[6])==null?null:dbConnection.dateConvert(a[6]));
            ps.setString(8, (a[7]==null)?"":a[7]);
            ps.setString(9, (a[8]==null)?"":a[8]); //asset_status
            ps.setString(10, (a[9]==null)?"":a[9]);
            ps.setString(11, a[10]);
            ps.setString(12, timer.format(new java.util.Date()));
            ps.setString(13,mtid);
            ps.setString(14, mtid);
            ps.setInt(15, transaction_level);

            ps.execute();

        }
        catch(Exception er)
        {
            System.out.println(">>>AssetRecordBeans:setPendingTrans(>>>>>>" + er);

        }finally{
        dbConnection.closeConnection(con, ps);

        }

   //String pq = "insert into am_asset_approval(asset_id,user_id,super_id,amount,posting_date,description,effective_date,branchCode,tran_type, process_status,tran_sent_time) values(?,?,?,?,?,?,?,?,?,?,?)";






    }//staticApprovalInfo()


public String timeInstance() {
        DateFormat t = DateFormat.getTimeInstance();
        return t.format(new Date());

    }




public String[] setApprovalData(String id){

//String q ="select asset_id, asset_status,user_ID,supervisor,Cost_Price,Posting_Date,description,effective_date,BRANCH_CODE from am_asset where asset_id ='" +id+"'";
   String[] result= new String[12];
    Connection con = null;
        PreparedStatement ps = null;
        ResultSet rs = null;

         String query ="select asset_id,user_ID,supervisor,Cost_Price,Posting_Date,description,effective_date,BRANCH_CODE,Asset_Status from am_asset where asset_id ='" +id+"'"; ;



        try {
            con = dbConnection.getConnection("fixedasset");
            ps = con.prepareStatement(query);
            rs = ps.executeQuery();
            while (rs.next()) {
                result[0] = rs.getString(1);
                result[1]= rs.getString(2);
                result[2] = rs.getString(3);
               result[3] = rs.getString(4);
               result[4] = rs.getString(5);
               result[5] = rs.getString(6);
               result[6] = rs.getString(7);
               result[7] = rs.getString(8);
               result[8] = rs.getString(9);//asset_status

            }

        } catch (Exception ex) {
            System.out.println("WARN: Error fetching CategoryCode ->" + ex);
        } finally {
            dbConnection.closeConnection(con, ps);
        }
result[9] = "Asset Creation";
result[10] = "P";
//result[11] = timeInstance();
        return result;

}//setApprovalData()

    /**
     * @return the processin_status
     */
   public String getTransDetails(String asset_id){
   String query = "select process_status from am_asset_approval where asset_id ='"+asset_id+"'";
   String result="";
    Connection con = null;
        PreparedStatement ps = null;
        ResultSet rs = null;

         



        try {
            con = dbConnection.getConnection("fixedasset");
            ps = con.prepareStatement(query);
            rs = ps.executeQuery();
            while (rs.next()) {
                result = rs.getString(1);
               
            }

        } catch (Exception ex) {
            System.out.println("WARN: Error fetching CategoryCode ->" + ex);
        } finally {
            dbConnection.closeConnection(con, ps);
        }

        return result;

   
   } //getTransactionDetails()

public void getTransFeedback(String id, String process_status, String reject_reason,int tran_id){
String query_r ="update am_asset_approval set process_status=?,reject_reason=? where asset_id = '"+id+"'and transaction_id="+tran_id;
    //System.out.println("the value of  ==============" + id);
Connection con = null;
        PreparedStatement ps = null;
        //ResultSet rs = null;

try {
    con = dbConnection.getConnection("fixedasset");

if(process_status.equalsIgnoreCase("a")||process_status.equalsIgnoreCase("p")){
reject_reason = "";
}
ps = con.prepareStatement(query_r);



            ps.setString(1,process_status);
            ps.setString(2,reject_reason);
           int i =ps.executeUpdate();
            //ps.execute();
//System.out.println("the value of i is =========="+ i);
        } catch (Exception ex) {

            System.out.println("AssetRecordBean: getTransFeedback()>>>>>" + ex);
        } finally {
            dbConnection.closeConnection(con, ps);
        }

}//getTransFeedback()







public void updateAssetStatusApproval(int transId){
//String query_r ="update am_asset_approval set asset_status=? where asset_id = '"+assetId+"'";
String query_r ="update am_asset_approval set asset_status=? where transaction_id = ?";
Connection con = null;
        PreparedStatement ps = null;
        //ResultSet rs = null;

try {
    con = dbConnection.getConnection("fixedasset");


ps = con.prepareStatement(query_r);



            ps.setString(1,"ACTIVE");
            ps.setInt(2, transId);
            //ps.setString(2,reject_reason);
           int i =ps.executeUpdate();
            //ps.execute();

        } catch (Exception ex) {

            System.out.println("AssetRecordBean: updateAssetStatusApproval()>>>>>" + ex);
        } finally {
            dbConnection.closeConnection(con, ps);
        }


}//updateAssetStatusApproval()


public void updateAssetStatus(String assetId){
String query_r ="update am_asset set asset_status=?,raise_entry=? where asset_id = '"+assetId+"'";

Connection con = null;
        PreparedStatement ps = null;
        //ResultSet rs = null;

try {
    con = dbConnection.getConnection("fixedasset");


ps = con.prepareStatement(query_r);



            ps.setString(1,"ACTIVE");
            ps.setString(2,"Y");
            //ps.setString(2,reject_reason);
           int i =ps.executeUpdate();
            //ps.execute();

        } catch (Exception ex) {

            System.out.println("AssetRecordBean: updateAssetStatus()>>>>>" + ex);
        } finally {
            dbConnection.closeConnection(con, ps);
        }


}//updateAssetStatus()

public String getDisposalSupervisor(String id, String trans_type){
  String query = "select super_id from am_asset_approval where asset_id ='"+id+"'and tran_type ='"+trans_type+"'";
   String result="";
    Connection con = null;
        PreparedStatement ps = null;
        ResultSet rs = null;





        try {
            con = dbConnection.getConnection("fixedasset");
            ps = con.prepareStatement(query);
            rs = ps.executeQuery();
            while (rs.next()) {
                result = rs.getString(1);

            }

        } catch (Exception ex) {
            System.out.println("WARN: Error fetching CategoryCode ->" + ex);
        } finally {
            dbConnection.closeConnection(con, ps);
        }

        return result;





}//getDisposalSupervisor()

public String[] setDisposalData(String id){

//String q ="select asset_id, asset_status,user_ID,supervisor,Cost_Price,Posting_Date,description,effective_date,BRANCH_CODE from am_asset where asset_id ='" +id+"'";
   String[] result= new String[12];
    Connection con = null;
        PreparedStatement ps = null;
        ResultSet rs = null;

         String query ="select asset_id,user_ID,supervisor,Cost_Price,Posting_Date,description,effective_date,BRANCH_CODE,Asset_Status from am_asset where asset_id ='" +id+"'"; ;



        try {
            con = dbConnection.getConnection("fixedasset");
            ps = con.prepareStatement(query);
            rs = ps.executeQuery();
            while (rs.next()) {
                result[0] = rs.getString(1);
                result[1]= rs.getString(2);
                result[2] = rs.getString(3);
               result[3] = rs.getString(4);
               result[4] = rs.getString(5);
               result[5] = rs.getString(6);
               result[6] = rs.getString(7);
               result[7] = rs.getString(8);
               result[8] = rs.getString(9);//asset_status

            }

        } catch (Exception ex) {
            System.out.println("WARN: Error fetching CategoryCode ->" + ex);
        } finally {
            dbConnection.closeConnection(con, ps);
        }
result[9] = "Asset Creation";
result[10] = "P";
//result[11] = timeInstance();
        return result;

}//setApprovalData()


public void updateAssetStatusChange(String query_r){
//String query_r ="update" +tableName+ "set"+columnName+"=? where asset_id = '"+assetId+"'";

Connection con = null;
        PreparedStatement ps = null;
        //ResultSet rs = null;

try {
    con = dbConnection.getConnection("fixedasset");


ps = con.prepareStatement(query_r);

   // System.out.println("in update asset status change of asset records beans================");

            //ps.setString(1,status);
            //ps.setString(2,reject_reason);
           int i =ps.executeUpdate();
            //ps.execute();

        } catch (Exception ex) {

            System.out.println("AssetRecordBean: updateAssetStatusChange()>>>>>" + ex);
        } finally {
            dbConnection.closeConnection(con, ps);
        }


}//updateAssetStatus()


///////////////lanre modification to assetRecordsBean//////////////////////////////////////////
/*
public String checkBranchCode()
	{
		String branch="";
		String query="SELECT BRANCH_CODE FROM AM_ASSET";

		Connection con = null;
		PreparedStatement ps = null;
		ResultSet rs = null;

		try {

			con = dbConnection.getConnection("fixedasset");

			ps = con.prepareStatement(query);

			rs = ps.executeQuery();

			while (rs.next())
			 {

				branch  = rs.getString("BRANCH_CODE");


			 }
		   }
			catch (Exception er)
			{
			 er.printStackTrace();

			}
			finally
			{
				dbConnection.closeConnection(con, ps);
			}
	return 	branch;
	}

*/
	public String checkBranchCode(String Asset_id)
	{
		String branch="";
		String query="SELECT BRANCH_CODE FROM AM_ASSET where Asset_id='"+Asset_id+"'";

		Connection con = null;
		PreparedStatement ps = null;
		ResultSet rs = null;

		try {

			con = dbConnection.getConnection("fixedasset");

			ps = con.prepareStatement(query);

			rs = ps.executeQuery();

			while (rs.next())
			 {

				branch  = rs.getString("BRANCH_CODE");


			 }
		   }
			catch (Exception er)
			{
			 er.printStackTrace();

			}
			finally
			{
				dbConnection.closeConnection(con, ps);
			}
	return 	branch;
	}
	/*
	public String subjectToVat(String Asset_id)
	{
		String subjectVat="";
		String query="SELECT Subject_TO_Vat FROM AM_ASSET where Asset_id='"+Asset_id+"'";

		Connection con = null;
		PreparedStatement ps = null;
		ResultSet rs = null;

		try {

			con = dbConnection.getConnection("fixedasset");

			ps = con.prepareStatement(query);

			rs = ps.executeQuery();

			while (rs.next())
			 {

				subjectVat  = rs.getString("Subject_TO_Vat");


			 }
		   }
			catch (Exception er)
			{
			 er.printStackTrace();

			}
			finally
			{
				dbConnection.closeConnection(con, ps);
			}
	return 	subjectVat;
	}

    */

    /*
	public String whTax(String Asset_id)
	{
		String whTax="";
		String query="SELECT WH_TAX FROM AM_ASSET  where Asset_id='"+Asset_id+"'";

		Connection con = null;
		PreparedStatement ps = null;
		ResultSet rs = null;

		try {

			con = dbConnection.getConnection("fixedasset");

			ps = con.prepareStatement(query);

			rs = ps.executeQuery();

			while (rs.next())
			 {

				whTax  = rs.getString("WH_TAX");


			 }
		   }
			catch (Exception er)
			{
			 er.printStackTrace();

			}
			finally
			{
				dbConnection.closeConnection(con, ps);
			}
	return 	whTax;
	}


    */
	public String checkCategoryCode(String Asset_id)
	{
		String category="";
		String query="SELECT CATEGORY_CODE FROM AM_ASSET  where Asset_id='"+Asset_id+"'";

		Connection con = null;
		PreparedStatement ps = null;
		ResultSet rs = null;

		try {

			con = dbConnection.getConnection("fixedasset");

			ps = con.prepareStatement(query);

			rs = ps.executeQuery();

			while (rs.next())
			 {

				category  = rs.getString("CATEGORY_CODE");


			 }
		   }
			catch (Exception er)
			{
			 er.printStackTrace();

			}
			finally
			{
				dbConnection.closeConnection(con, ps);
			}
	return 	category;
	}

    /*
	public String checkCategoryCode()
	{
		String category="";
		String query="SELECT CATEGORY_CODE FROM AM_ASSET";

		Connection con = null;
		PreparedStatement ps = null;
		ResultSet rs = null;

		try {

			con = dbConnection.getConnection("fixedasset");

			ps = con.prepareStatement(query);

			rs = ps.executeQuery();

			while (rs.next())
			 {

				category  = rs.getString("CATEGORY_CODE");


			 }
		   }
			catch (Exception er)
			{
			 er.printStackTrace();

			}
			finally
			{
				dbConnection.closeConnection(con, ps);
			}
	return 	category;
	}

    */
	public String checkAssetLedgerAccount(String category,String branch)
	{
		String assetledgeraccount="";
		System.out.println("category "+category);
		System.out.println("branch "+branch);
		String query=" select c.iso_code,"
					+" (select accronym from am_ad_ledger_type where series = substring(b.asset_acq_ac,1,1)),"
					+" d.branch_code,"
					+" b.asset_acq_ac,"
					+" c.iso_code +(select accronym from am_ad_ledger_type where series = substring(b.asset_acq_ac,1,1))+"
					+" d.branch_code + b.asset_acq_ac asd"
					+" from am_ad_category a,am_ad_branch d, "
					+" AM_GB_CURRENCY_CODE c, am_gb_company b"
					+" where a.currency_id = c.currency_id"
					+" and a.category_code = '"+category+"'"
					+" and d.branch_code = '"+branch+"'";

		Connection con = null;
		PreparedStatement ps = null;
		ResultSet rs = null;

		try {

			con = dbConnection.getConnection("fixedasset");

			ps = con.prepareStatement(query);

			rs = ps.executeQuery();

			if (rs.next())
			 {

				 assetledgeraccount  = rs.getString("asd");


			 }
		   }
			catch (Exception er)
			{
			 er.printStackTrace();

			}
			finally
			{
				dbConnection.closeConnection(con, ps);
			}
	return 	assetledgeraccount;
	}

	public String checkAccounAcqusitionSuspense (String category,String branch)
	{
		String assetAcqusitionSuspense="";
		System.out.println("category "+category);
		System.out.println("branch "+branch);
		String query=" select c.iso_code,"
					+" (select accronym from am_ad_ledger_type where series = substring(a.Asset_Ledger,1,1)),"
					+" d.branch_code,"
					+" a.Asset_Ledger,"
					+" c.iso_code +(select accronym from am_ad_ledger_type where series = substring(a.Asset_Ledger,1,1))+"
					+" d.branch_code +	a.Asset_Ledger asd"
					+" from am_ad_category a,am_ad_branch d, AM_GB_CURRENCY_CODE c, am_gb_company b"
					+" where a.currency_id = c.currency_id"
					+" and a.category_code = '"+category+"'"
					+" and d.branch_code = '"+branch+"'";

		Connection con = null;
		PreparedStatement ps = null;
		ResultSet rs = null;

		try {

			con = dbConnection.getConnection("fixedasset");

			ps = con.prepareStatement(query);

			rs = ps.executeQuery();

			if (rs.next())
			 {

				assetAcqusitionSuspense  = rs.getString("asd");


			 }
		   }
			catch (Exception er)
			{
			 er.printStackTrace();

			}
			finally
			{
				dbConnection.closeConnection(con, ps);
			}
	return 	assetAcqusitionSuspense;
	}
	public String assetProcurementDr (String category,String branch)
	{
		String assetAcqusitionSuspense="";
		System.out.println("category "+category);
		System.out.println("branch "+branch);
		String query=" select c.iso_code,"
					+" (select accronym from am_ad_ledger_type where series = substring(a.Asset_Ledger,1,1)),"
					+" d.branch_code,"
					+" a.Asset_Ledger,"
					+" c.iso_code +(select accronym from am_ad_ledger_type where series = substring(a.Asset_Ledger,1,1))+"
					+" d.branch_code +	a.Asset_Ledger asd"
					+" from am_ad_category a,am_ad_branch d, AM_GB_CURRENCY_CODE c, am_gb_company b"
					+" where a.currency_id = c.currency_id"
					+" and a.category_code = '"+category+"'"
					+" and d.branch_code = '"+branch+"'";

		Connection con = null;
		PreparedStatement ps = null;
		ResultSet rs = null;

		try {

			con = dbConnection.getConnection("fixedasset");

			ps = con.prepareStatement(query);

			rs = ps.executeQuery();

			if (rs.next())
			 {

				assetAcqusitionSuspense  = rs.getString("asd");


			 }
		   }
			catch (Exception er)
			{
			 er.printStackTrace();

			}
			finally
			{
				dbConnection.closeConnection(con, ps);
			}
	return 	assetAcqusitionSuspense;
	}
	public String assetProcurementCr (String category,String branch)
	{
		String assetAcqusitionSuspense="";
		System.out.println("category "+category);
		System.out.println("branch "+branch);
		String query=" select c.iso_code,"
					+" (select accronym from am_ad_ledger_type where series = substring(a.Asset_Ledger,1,1)),"
					+" d.branch_code,"
					+" a.Asset_Ledger,"
					+" c.iso_code +(select accronym from am_ad_ledger_type where series = substring(a.Asset_Ledger,1,1))+"
					+" d.branch_code +	a.Asset_Ledger asd"
					+" from am_ad_category a,am_ad_branch d, AM_GB_CURRENCY_CODE c, am_gb_company b"
					+" where a.currency_id = c.currency_id"
					+" and a.category_code = '"+category+"'"
					+" and d.branch_code = '"+branch+"'";

		Connection con = null;
		PreparedStatement ps = null;
		ResultSet rs = null;

		try {

			con = dbConnection.getConnection("fixedasset");

			ps = con.prepareStatement(query);

			rs = ps.executeQuery();

			if (rs.next())
			 {

				assetAcqusitionSuspense  = rs.getString("asd");


			 }
		   }
			catch (Exception er)
			{
			 er.printStackTrace();

			}
			finally
			{
				dbConnection.closeConnection(con, ps);
			}
	return 	assetAcqusitionSuspense;
	}
	public String assetVatDr (String category,String branch)
	{
		String assetAcqusitionSuspense="";
		System.out.println("category "+category);
		System.out.println("branch "+branch);
		String query=" select c.iso_code,"
					+" (select accronym from am_ad_ledger_type where series = substring(a.Asset_Ledger,1,1)),"
					+" d.branch_code,"
					+" a.Asset_Ledger,"
					+" c.iso_code +(select accronym from am_ad_ledger_type where series = substring(a.Asset_Ledger,1,1))+"
					+" d.branch_code +	a.Asset_Ledger asd"
					+" from am_ad_category a,am_ad_branch d, AM_GB_CURRENCY_CODE c, am_gb_company b"
					+" where a.currency_id = c.currency_id"
					+" and a.category_code = '"+category+"'"
					+" and d.branch_code = '"+branch+"'";



		Connection con = null;
		PreparedStatement ps = null;
		ResultSet rs = null;

		try {

			con = dbConnection.getConnection("fixedasset");

			ps = con.prepareStatement(query);

			rs = ps.executeQuery();

			if (rs.next())
			 {

				assetAcqusitionSuspense  = rs.getString("asd");


			 }
		   }
			catch (Exception er)
			{
			 er.printStackTrace();

			}
			finally
			{
				dbConnection.closeConnection(con, ps);
			}
	return 	assetAcqusitionSuspense;
	}

	public String witholdingFedTaxCr (String category,String branch)
	{
		String assetAcqusitionSuspense="";
		System.out.println("category "+category);
		System.out.println("branch "+branch);
		String query=" select c.iso_code,"
					+" (select accronym from am_ad_ledger_type where series = substring(b.fed_wht_account,1,1)),"
					+" d.branch_code,"
					+" b.fed_wht_account,"
					+" c.iso_code +(select accronym from am_ad_ledger_type where series = substring(b.fed_wht_account,1,1))+"
					+" d.branch_code +	b.fed_wht_account asd"
					+" from am_ad_category a,am_ad_branch d, AM_GB_CURRENCY_CODE c,am_gb_company b"
					+" where a.currency_id = c.currency_id"
					+" and a.category_code = '"+category+"'"
					+" and d.branch_code = '"+branch+"'";

		Connection con = null;
		PreparedStatement ps = null;
		ResultSet rs = null;

		try {

			con = dbConnection.getConnection("fixedasset");

			ps = con.prepareStatement(query);

			rs = ps.executeQuery();

			if (rs.next())
			 {

				assetAcqusitionSuspense  = rs.getString("asd");


			 }
		   }
			catch (Exception er)
			{
			 er.printStackTrace();

			}
			finally
			{
				dbConnection.closeConnection(con, ps);
			}
	return 	assetAcqusitionSuspense;
	}

	public String stateWHTaxCr (String category,String branch)
	{
		String assetAcqusitionSuspense="";
		System.out.println("category "+category);
		System.out.println("branch "+branch);
		String query=" select c.iso_code,"
					+" (select accronym from am_ad_ledger_type where series = substring(b.wht_account,1,1)),"
					+" d.branch_code,"
					+" b.wht_account,"
					+" c.iso_code +(select accronym from am_ad_ledger_type where series = substring(b.wht_account,1,1))+"
					+" d.branch_code +	b.wht_account asd"
					+" from am_ad_category a,am_ad_branch d, AM_GB_CURRENCY_CODE c,am_gb_company b"
					+" where a.currency_id = c.currency_id"
					+" and a.category_code = '"+category+"'"
					+" and d.branch_code = '"+branch+"'";

		Connection con = null;
		PreparedStatement ps = null;
		ResultSet rs = null;

		try {

			con = dbConnection.getConnection("fixedasset");

			ps = con.prepareStatement(query);

			rs = ps.executeQuery();

			if (rs.next())
			 {

				assetAcqusitionSuspense  = rs.getString("asd");


			 }
		   }
			catch (Exception er)
			{
			 er.printStackTrace();

			}
			finally
			{
				dbConnection.closeConnection(con, ps);
			}
	return 	assetAcqusitionSuspense;
	}


	public String stateSuspenseAcct (String category,String branch)
	{
		String assetAcqusitionSuspense="";
		System.out.println("category "+category);
		System.out.println("branch "+branch);
		String query=" select c.iso_code,"
					+" (select accronym from am_ad_ledger_type where series = substring(b.wht_account,1,1)),"
					+" d.branch_code,"
					+" b.suspense_acct,"
					+" c.iso_code +(select accronym from am_ad_ledger_type where series = substring(b.asset_acq_ac,1,1))+"
					+" d.branch_code +	b.suspense_acct asd"
					+" from am_ad_category a,am_ad_branch d, AM_GB_CURRENCY_CODE c,am_gb_company b"
					+" where a.currency_id = c.currency_id"
					+" and a.category_code = '"+category+"'"
					+" and d.branch_code = '"+branch+"'";

		Connection con = null;
		PreparedStatement ps = null;
		ResultSet rs = null;

		try {

			con = dbConnection.getConnection("fixedasset");

			ps = con.prepareStatement(query);

			rs = ps.executeQuery();

			if (rs.next())
			 {

				assetAcqusitionSuspense  = rs.getString("asd");


			 }
		   }
			catch (Exception er)
			{
			 er.printStackTrace();

			}
			finally
			{
				dbConnection.closeConnection(con, ps);
			}
	return 	assetAcqusitionSuspense;
	}



	public String statePLDisposalAccount (String category,String branch)
	{
		String assetAcqusitionSuspense="";
		System.out.println("category "+category);
		System.out.println("branch "+branch);
		String query=" select c.iso_code,"
					+" (select accronym from am_ad_ledger_type where series = substring(b.wht_account,1,1)),"
					+" d.branch_code,"
					+" b.PL_Disposal_account,"
					+" c.iso_code +(select accronym from am_ad_ledger_type where series = substring(b.PL_Disposal_account,1,1))+"
					+" d.branch_code +	b.PL_Disposal_account asd"
					+" from am_ad_category a,am_ad_branch d, AM_GB_CURRENCY_CODE c,am_gb_company b"
					+" where a.currency_id = c.currency_id"
					+" and a.category_code = '"+category+"'"
					+" and d.branch_code = '"+branch+"'";

		Connection con = null;
		PreparedStatement ps = null;
		ResultSet rs = null;

		try {

			con = dbConnection.getConnection("fixedasset");

			ps = con.prepareStatement(query);

			rs = ps.executeQuery();

			if (rs.next())
			 {

				assetAcqusitionSuspense  = rs.getString("asd");


			 }
		   }
			catch (Exception er)
			{
			 er.printStackTrace();

			}
			finally
			{
				dbConnection.closeConnection(con, ps);
			}
	return 	assetAcqusitionSuspense;
	}
	public String stateAccumDepLedger (String category,String branch)
	{
		String assetAcqusitionSuspense="";
		System.out.println("category "+category);
		System.out.println("branch "+branch);
		String query=" select c.iso_code,"
					+" (select accronym from am_ad_ledger_type where series = substring(b.wht_account,1,1)),"
					+" d.branch_code,"
					+" a.Accum_Dep_ledger,"
					+" c.iso_code +(select accronym from am_ad_ledger_type where series = substring(a.Accum_Dep_ledger,1,1))+"
					+" d.branch_code +	a.Accum_Dep_ledger asd"
					+" from am_ad_category a,am_ad_branch d, AM_GB_CURRENCY_CODE c,am_gb_company b"
					+" where a.currency_id = c.currency_id"
					+" and a.category_code = '"+category+"'"
					+" and d.branch_code = '"+branch+"'";

		Connection con = null;
		PreparedStatement ps = null;
		ResultSet rs = null;

		try {

			con = dbConnection.getConnection("fixedasset");

			ps = con.prepareStatement(query);

			rs = ps.executeQuery();

			if (rs.next())
			 {

				assetAcqusitionSuspense  = rs.getString("asd");


			 }
		   }
			catch (Exception er)
			{
			 er.printStackTrace();

			}
			finally
			{
				dbConnection.closeConnection(con, ps);
			}
	return 	assetAcqusitionSuspense;
	}
	/*
    public String getCodeName(String query)
    {
     String result = "";
     Connection con = null;
     ResultSet rs = null;
     PreparedStatement ps = null;

     try
     {
      con = dbConnection.getConnection("fixedasset");
      ps = con.prepareStatement(query);
      rs = ps.executeQuery();


      while(rs.next())
      {
       result = rs.getString(1) == null ? "" : rs.getString(1);

      }
     }
     catch(Exception er)
     {
        System.out.println("Error in Query- getCodeName()... ->"+er);
        er.printStackTrace();
     }finally{
    	 dbConnection.closeConnection(con, ps);
      }
      return result;
     }
*/
    	public boolean checkApprovalStatus(String id)
	{
            boolean status = false;

            String asset_status="";
		String query="SELECT asset_status FROM AM_ASSET where asset_id ='"+id+"'";

		Connection con = null;
		PreparedStatement ps = null;
		ResultSet rs = null;

		try {

			con = dbConnection.getConnection("fixedasset");

			ps = con.prepareStatement(query);

			rs = ps.executeQuery();

			while (rs.next())
			 {

				asset_status  = rs.getString("asset_status");


			 }
            if(asset_status.equalsIgnoreCase("active")){
            status = true;
            }
		   }

			catch (Exception er)
			{
			 er.printStackTrace();

			}
			finally
			{
				dbConnection.closeConnection(con, ps);
			}
	return 	status;
	}


        public void setPendingTranValues(String query){
            System.out.println("in method setPendingTranValues with queryJJJJJJJJJJJJJJJJ" +query);
        Connection con;
        PreparedStatement ps;
        ResultSet rs;

        //query = "INSERT INTO REQUISITIONFORM VALUES(?,?,?,?,?,?)";
        con = null;
        ps = null;
        //rs = null;
        try
        {
            con = dbConnection.getConnection("fixedasset");
            ps = con.prepareStatement(query);

            ps.execute();

        }
        catch(Exception er)
        {
            er.printStackTrace();

        }finally{

        dbConnection.closeConnection(con, ps);


        }


        }//setPendingTranValues
        
        
        public String[] setApprovalDataGroup(long id){

//String q ="select asset_id, asset_status,user_ID,supervisor,Cost_Price,Posting_Date,description,effective_date,BRANCH_CODE from am_asset where asset_id ='" +id+"'";
   String[] result= new String[12];
    Connection con = null;
        PreparedStatement ps = null;
        ResultSet rs = null;
        //int groupId = Integer.parseInt(id);
         String query ="select group_id,user_ID,supervisor,Cost_Price,Posting_Date,description,effective_date,BRANCH_CODE,Asset_Status from am_group_asset_main where group_id =" +id ;



        try {
            con = dbConnection.getConnection("fixedasset");
            ps = con.prepareStatement(query);
            rs = ps.executeQuery();
            while (rs.next()) {
                result[0] = rs.getString(1);
                result[1]= rs.getString(2);
                result[2] = rs.getString(3);
               result[3] = rs.getString(4);
               result[4] = rs.getString(5);
               result[5] = rs.getString(6);
               result[6] = rs.getString(7);
               result[7] = rs.getString(8);
               result[8] = rs.getString(9);//asset_status

            }

        } catch (Exception ex) {
            System.out.println("AssetRecordsBean : setApprovalData()WARN: Error setting approval data for group asset creation ->" + ex);
        } finally {
            dbConnection.closeConnection(con, ps);
        }
result[9] = "Group Asset Creation";
result[10] = "P";
//result[11] = timeInstance();
        return result;

}//setApprovalData()




public void incrementApprovalCount(int tran_id,int count,int nextSupervisor){
String query_r ="update am_asset_approval set approval_level_count=?,super_id=? where transaction_id =?";

Connection con = null;
        PreparedStatement ps = null;
        //ResultSet rs = null;

try {
    con = dbConnection.getConnection("fixedasset");


ps = con.prepareStatement(query_r);



            ps.setInt(1,count);
            ps.setInt(2, nextSupervisor);
            ps.setInt(3,tran_id);
            //ps.setString(2,reject_reason);
           int i =ps.executeUpdate();
            //ps.execute();

        } catch (Exception ex) {

            System.out.println("AssetRecordBean: incrementApprovalCount()>>>>>" + ex);
        } finally {
            dbConnection.closeConnection(con, ps);
        }


}//incrementApprovalCount()

    /**
     * @return the deferPay
     */
    public String getDeferPay() {
        return deferPay;
    }

    /**
     * @param deferPay the deferPay to set
     */
    public void setDeferPay(String deferPay) {
        if(deferPay!=null){
		this.deferPay = deferPay;}

        //this.deferPay = deferPay;
    }

/*

public boolean insertComponent(String parentAssetId, String parentCompId,
            String category, String description, String serialNumber, String make, String model,
            String additionalField,String Componet,double cost,double assigned,double depreciation,
            String registration_no,String branch_id,String department_id,String section_id,String  vendor_account,
            String date_of_purchase,String  getDepreciationRate,String engine_number,String supplied_by,
            String user,String  maintained_by,int A,int B,String costPrice1,double costPrice2,String depreciation_end_date,
            String residual_value,String authorized_by,String wh_tax_cb,String wh_tax_amount,String require_depreciation,
            String depreciation_start_date,String reason,String C,String computeTotalLife,String location,String computeTotalLife2,
            String vatable_cost,String vat_amount,String require_redistribution,String subject_to_vat,String who_to_remind,
            String email_1,String who_to_remind_2,String email2,String raise_entry,String D,String section,String state,String driver,
            String spare_2,String user_id,String  province,String  multiple,String warrantyStartDate,int noOfMonths,String expiryDate,
            String getBranchCode,String getSectionCode,String getDeptCode,String getCategoryCode,String amountPTD,double  amountPTD2,
            String partPAY,String fullyPAID,String  group_id,String  bar_code,String sbu_code,String lpo,String getSupervisor ) throws Exception, Throwable
    {
    	String assetId = comp.createComponentAssetIdDelimiter(parentAssetId,description);
        Connection con = null;
        PreparedStatement ps = null;
        boolean done = true;


        if (make == null || make.equals("")) {
            make = "0";
        }
        if (maintained_by == null || maintained_by.equals("")) {
            maintained_by = "0";
        }
        if (supplied_by == null || supplied_by.equals("")) {
            supplied_by = "0";
        }
        if (user == null || user.equals("")) {
            user = "";
        }
        if (location == null || location.equals("")) {
            location = "0";
        }
        if (driver == null || driver.equals("")) {
            driver = "0";
        }
        if (state == null || state.equals("")) {
            state = "0";
        }
        if (department_id == null || department_id.equals("")) {
            department_id = "0";
        }
        if (vat_amount == null || vat_amount.equals("")) {
            vat_amount = "0.0";
        }
        if (vatable_cost == null || vatable_cost.equals("")) {
            vatable_cost = "0.0";
        }
        if (wh_tax_amount == null || wh_tax_amount.equals("")) {
            wh_tax_amount = "0";
        }
        if (branch_id == null || branch_id.equals("")) {
            branch_id = "0";
        }
        if (province == null || province.equals("")) {
            province = "0";
        }
        if (category_id == null || category_id.equals("")) {
            category_id = "0";
        }

        if (residual_value == null || residual_value.equals("")) {
            residual_value = "0";
        }
        if (section_id == null || section_id.equals("")) {
            section_id = "0";
        }


        if (warrantyStartDate == null || warrantyStartDate.equals("")) {
            warrantyStartDate = null;
        }
        if (expiryDate == null || expiryDate.equals("")) {
            expiryDate = null;
        }

        vat_amount = vat_amount.replaceAll(",", "");
        vatable_cost = vatable_cost.replaceAll(",", "");
        wh_tax_amount = wh_tax_amount.replaceAll(",", "");
        residual_value = residual_value.replaceAll(",", "");
        amountPTD = amountPTD.replaceAll(",","");



        String createQuery = "INSERT INTO AM_AD_COMPONENT ( PARENT_ASSET_ID,PARENT_COMP_ID ,ASSET_ID ,CATEGORY    " +
                             "  ,DESCRIPTION,SERIAL_NO,MAKE,MODEL ,ADDITIONAL_FIELD,STATUS,COMPONENT ,COST    " +
                             "  ,ASSIGNED,DEPRECIATION " +
                             "  ,Registration_No,Branch_ID,Dept_ID,Section_id,Vendor_AC    " +
                             " ,Date_purchased,Dep_Rate ,Asset_Engine_No ,Supplier_Name,Asset_User,Asset_Maintenance    " +
                             " ,Accum_Dep ,Monthly_Dep,Cost_Price ,NBV ,Dep_End_Date,Residual_Value ,Authorized_By    " +
                             " ,Wh_Tax   ,Wh_Tax_Amount  ,Req_Redistribution    " +
                             " ,Posting_Date  ,Effective_Date  ,Purchase_Reason ,Useful_Life ,Total_Life    " +
                             " ,Location  ,Remaining_Life  ,Vatable_Cost  ,Vat ,Req_Depreciation    " +
                             " ,Subject_TO_Vat   ,Who_TO_Rem  ,Email1 ,Who_To_Rem_2  ,Email2    " +
                             " ,Raise_Entry ,Dep_Ytd  ,Section  ,State ,Driver  ,Spare_2    " +
                             " ,User_ID  ,Date_Disposed ,PROVINCE ,Multiple  ,WAR_START_DATE    " +
                             " ,WAR_MONTH ,WAR_EXPIRY_DATE ,Last_Dep_Date ,BRANCH_CODE ,SECTION_CODE    " +
                             " ,DEPT_CODE ,CATEGORY_CODE  ,AMOUNT_PTD ,AMOUNT_REM  ,PART_PAY    " +
                             " ,FULLY_PAID  ,GROUP_ID ,BAR_CODE  ,SBU_CODE ,LPO ,supervisor ) " +
                             " VALUES(?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,  " +
                             " ?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?) ";
        try {
            double costPrice = Double.parseDouble(vat_amount) + Double.parseDouble(vatable_cost);
            int Accum_Dep = 0;//Integer.parseInt(String.valueOf(assigned));
            int Monthly_Dep=0;
            con = dbConnection.getConnection("fixedasset");
            ps = con.prepareStatement(createQuery);
            ps.setString(1, parentAssetId);
            ps.setInt(2, new Integer(parentCompId).intValue());
            ps.setString(3, assetId);
            ps.setInt(4, new Integer(category).intValue());
            ps.setString(5, description);
            ps.setString(6, serialNumber);
            ps.setString(7, make);
            ps.setString(8, model);
            ps.setString(9, additionalField);
            ps.setString(10, "ACTIVE");
            ps.setString(11, Componet);
            ps.setDouble(12, cost);
            ps.setDouble(13, assigned);
            ps.setDouble(14, depreciation);
            ps.setString(15, registration_no);
            ps.setInt(16, Integer.parseInt(branch_id));
            ps.setInt(17, Integer.parseInt(department_id));
            ps.setInt(18, Integer.parseInt(section_id));
            ps.setString(19, vendor_account);
            ps.setDate(20, dbConnection.dateConvert(date_of_purchase));

            ps.setString(21, getDepreciationRate(category));
            ps.setString(22, engine_number);
            ps.setInt(23, Integer.parseInt(supplied_by));
            ps.setString(24, user);
            ps.setInt(25, Integer.parseInt(maintained_by));
            ps.setInt(26, Accum_Dep);
            ps.setInt(27, Monthly_Dep);
            ps.setDouble(28, costPrice);
            ps.setDouble(29, costPrice);
            ps.setDate(30, dbConnection.dateConvert(depreciation_end_date));
            ps.setDouble(31, Double.parseDouble(residual_value));
            ps.setString(32, authorized_by);
            ps.setString(33, wh_tax_cb);
            ps.setDouble(34, Double.parseDouble(wh_tax_amount));
            ps.setString(35, require_depreciation);

            ps.setTimestamp(36, dbConnection.getDateTime(new java.util.Date()));
            ps.setDate(37, dbConnection.dateConvert(depreciation_start_date));
            ps.setString(38, reason);
            ps.setString(39, "0");
            ps.setString(40, computeTotalLife(getDepreciationRate(category)));
            ps.setInt(41, Integer.parseInt(location));
            ps.setString(42, computeTotalLife(getDepreciationRate(category)));
            ps.setDouble(43, Double.parseDouble(vatable_cost));
            ps.setDouble(44, Double.parseDouble(vat_amount));
            ps.setString(45, require_redistribution);
            ps.setString(46, subject_to_vat);
            ps.setString(47, who_to_remind);
            ps.setString(48, email_1);
            ps.setString(49, who_to_remind_2);
            ps.setString(50, email2);
            ps.setString(51, raise_entry);
            ps.setString(52, "0");
            ps.setString(53, section);
            ps.setInt(54, Integer.parseInt(state));
            ps.setInt(55, Integer.parseInt(driver));
            ps.setString(56, spare_2);
            ps.setString(57, user_id);
            ps.setTimestamp(58, dbConnection.getDateTime(new java.util.Date()));
            ps.setString(59, province);
            ps.setString(60, multiple);
            ps.setDate(61, dbConnection.dateConvert(warrantyStartDate));
            ps.setInt(62, new Integer(noOfMonths).intValue());
            ps.setDate(63, dbConnection.dateConvert(expiryDate));
            ps.setTimestamp(64, dbConnection.getDateTime(new java.util.Date()));
            ps.setString(65, code.getBranchCode(branch_id));
            ps.setString(66, code.getSectionCode(section_id));
            ps.setString(67, code.getDeptCode(department_id));
            ps.setString(68, code.getCategoryCode(category));
            ps.setDouble(69, Double.parseDouble(amountPTD));
            ps.setDouble(70, (costPrice-Double.parseDouble(amountPTD)));
            ps.setString(71, partPAY);
            ps.setString(72, fullyPAID);
            ps.setString(73, group_id);
            ps.setString(74, bar_code);
            ps.setString(75,sbu_code);
            ps.setString(76, lpo);
            ps.setString(77,getSupervisor);

            System.out.println("parent id "+parentAssetId);
            System.out.println("parent comp "+new Integer(parentCompId).intValue());
            System.out.println("asset id "+assetId);
            System.out.println("catergry "+new Integer(category).intValue());
            System.out.println("desc "+description);
            System.out.println("sn "+serialNumber);
            System.out.println("make "+make);
            System.out.println("model "+model);
            System.out.println("add field "+additionalField);
            System.out.println("ACTIVE");
            System.out.println("copnt "+Componet);
            System.out.println("cost "+cost);
            System.out.println("assign "+assigned);
            System.out.println("deprton "+depreciation);
            System.out.println("reg no "+registration_no);
            System.out.println("branch id "+Integer.parseInt(branch_id));
            System.out.println("dept id "+Integer.parseInt(department_id));
            System.out.println("sect id "+Integer.parseInt(section_id));
            System.out.println("vendor acc "+vendor_account);
            System.out.println("date purchsed "+dbConnection.dateConvert(date_of_purchase));
            System.out.println("dep rate "+getDepreciationRate(category));
            System.out.println("eng no "+engine_number);
            System.out.println("supply by "+Integer.parseInt(supplied_by));
            System.out.println("user "+user);
            System.out.println("mentaned by "+Integer.parseInt(maintained_by));
            System.out.println(0);
            System.out.println(0);
            System.out.println("cost p "+costPrice);
            System.out.println("cost "+costPrice);
            System.out.println("dep end date "+dbConnection.dateConvert(depreciation_end_date));
            System.out.println("res val "+Double.parseDouble(residual_value));
            System.out.println("auth by "+authorized_by);
            System.out.println("wh tax cb "+wh_tax_cb);
            System.out.println("wh tax amount "+Double.parseDouble(wh_tax_amount));
            System.out.println("req dep "+require_depreciation);
            System.out.println("date sample "+dbConnection.getDateTime(new java.util.Date()));
            System.out.println("dep start date "+dbConnection.dateConvert(depreciation_start_date));
            System.out.println("reacson "+reason);
            System.out.println("0");
            System.out.println("comtotal life "+computeTotalLife(getDepreciationRate(category)));
            System.out.println("location "+Integer.parseInt(location));
            System.out.println("comptolife "+computeTotalLife(getDepreciationRate(category)));
            System.out.println("vatable cost "+Double.parseDouble(vatable_cost));
            System.out.println("vat amount "+Double.parseDouble(vat_amount));
            System.out.println("req redistbuton "+require_redistribution);
            System.out.println("sub to vat "+subject_to_vat);
            System.out.println("wh to remind "+who_to_remind);
            System.out.println("email1 "+email_1);
            System.out.println("who to remind 2 "+who_to_remind_2);
            System.out.println("email2 "+email2);
            System.out.println("raise "+raise_entry);
            System.out.println("0");
            System.out.println("section "+section);
            System.out.println("state "+Integer.parseInt(state));
            System.out.println("driver "+Integer.parseInt(driver));
            System.out.println("spare 2 "+spare_2);
            System.out.println("usr id "+user_id);
            System.out.println("date "+dbConnection.getDateTime(new java.util.Date()));
            System.out.println("province "+province);
            System.out.println("multiple "+multiple);
            System.out.println("warantystate "+dbConnection.dateConvert(warrantyStartDate));
            System.out.println("month s "+new Integer(noOfMonths).intValue());
            System.out.println(dbConnection.dateConvert(expiryDate));
            System.out.println("date "+dbConnection.getDateTime(new java.util.Date()));
            System.out.println("get branch code "+code.getBranchCode(branch_id));
            System.out.println("get secton code "+code.getSectionCode(section_id));
            System.out.println("get dept code "+code.getDeptCode(department_id));
            System.out.println("get category code "+code.getCategoryCode(category));
            System.out.println("amtptd "+Double.parseDouble(amountPTD));
            System.out.println("amtptd 2 "+(costPrice-Double.parseDouble(amountPTD)));
            System.out.println("part pay "+partPAY);
            System.out.println("fullypaiod "+fullyPAID);
            System.out.println("group id "+group_id);
            System.out.println("bar code "+bar_code);
            System.out.println("sbu code "+sbu_code);
            System.out.println("lpo "+lpo);
            System.out.println("get supvsr "+getSupervisor);
            ps.execute();


        } catch (Exception ex) {
            done = false;
            System.out.println("WARN:Error creating asset->" + ex);
        } finally {
            dbConnection.closeConnection(con, ps);
        }

        return done;
    }



*/

public ArrayList selectComponent(String  comp_Id)
    {

        Connection con = null;
        PreparedStatement ps = null;
        ResultSet rs = null;
        ComponentViewDetail app = null;
        ArrayList collection = new ArrayList();
        String FINDER_QUERY = "SELECT  * from AM_AD_COMPONENT WHERE comp_Id = ? ";

        try {
        	con = dbConnection.getConnection("fixedasset");
            ps = con.prepareStatement(FINDER_QUERY);
            ps.setString(1, comp_Id);

            rs = ps.executeQuery();

            while (rs.next())
             {



            	String id = rs.getString("COMP_ID");
            	String parentAssetId=rs.getString("PARENT_ASSET_ID") ;
            	String parentCompId=rs.getString("PARENT_COMP_ID");
            	String assetId=rs.getString("ASSET_ID");
            	String category=rs.getString("CATEGORY");
            	String description=rs.getString("DESCRIPTION");
            	String serialNumber=rs.getString("SERIAL_NO");
            	String make=rs.getString("MAKE");
            	String model=rs.getString("MODEL");
            	String additionalField=rs.getString("ADDITIONAL_FIELD");
            	String status=rs.getString("STATUS");
            	String component=rs.getString("COMPONENT");
            	double cost=rs.getDouble("COST");
            	double assigned=rs.getDouble("ASSIGNED");
            	double depreciation=rs.getDouble("DEPRECIATION");
            	String Registration_No=rs.getString("Registration_No");
            	int Branch_ID=rs.getInt("Branch_ID");
            	int Dept_ID=rs.getInt("Dept_ID");
            	int Section_id=rs.getInt("Section_id");
            	String Vendor_AC=rs.getString("Vendor_AC");
            	Date Date_purchased=rs.getDate("Date_purchased");
            	double Dep_Rate=rs.getDouble("Dep_Rate");
            	String Asset_Engine_No=rs.getString("Asset_Engine_No");
            	int Supplier_Name=rs.getInt("Supplier_Name");
            	String Asset_User=rs.getString("Asset_User");
            	int Asset_Maintenance=rs.getInt("Asset_Maintenance");
            	double Accum_Dep=rs.getDouble("Accum_Dep");
            	double Monthly_Dep=rs.getDouble("Monthly_Dep");
            	double Cost_Price=rs.getDouble("Cost_Price");
            	double NBV=rs.getDouble("NBV");
            	Date Dep_End_Date=rs.getDate("Dep_End_Date");
            	double Residual_Value=rs.getDouble("Residual_Value");
            	String Authorized_By=rs.getString("Authorized_By");
            	String Wh_Tax=rs.getString("Wh_Tax");
            	double Wh_Tax_Amount=rs.getDouble("Wh_Tax_Amount");
            	String Req_Redistribution=rs.getString("Req_Redistribution");
            	Date Posting_Date=rs.getDate("Posting_Date");
            	Date Effective_Date=rs.getDate("Effective_Date");
            	String Purchase_Reason=rs.getString("Purchase_Reason");
            	int Useful_Life=rs.getInt("Useful_Life");
            	int Total_Life=rs.getInt("Total_Life");
            	int Location=rs.getInt("Location");
            	int Remaining_Life=rs.getInt("Remaining_Life");
            	double Vatable_Cost=rs.getDouble("Vatable_Cost");
            	double Vat=rs.getDouble("Vat");
            	String Req_Depreciation=rs.getString("Req_Depreciation");
            	String Subject_TO_Vat=rs.getString("Subject_TO_Vat");
            	String Who_TO_Rem=rs.getString("Who_TO_Rem");
            	String Email1=rs.getString("Email1");
            	String Who_To_Rem_2=rs.getString("Who_To_Rem_2");
            	String Email2=rs.getString("Email2");
            	String Raise_Entry=rs.getString("Raise_Entry");
            	double Dep_Ytd=rs.getDouble("Dep_Ytd");
            	String Section=rs.getString("Section");
            	int State=rs.getInt("State");
            	int Driver=rs.getInt("Driver");
            	String Spare_2=rs.getString("Spare_2");
            	int User_ID=rs.getInt("User_ID");
            	Date Date_Disposed=rs.getDate("Date_Disposed");
            	int PROVINCE=rs.getInt("PROVINCE");
            	String Multiple=rs.getString("Multiple");
            	Date WAR_START_DATE=rs.getDate("WAR_START_DATE");
            	int WAR_MONTH=rs.getInt("WAR_MONTH");
            	Date WAR_EXPIRY_DATE=rs.getDate("WAR_EXPIRY_DATE");
            	Date Last_Dep_Date=rs.getDate("Last_Dep_Date");
            	String BRANCH_CODE=rs.getString("BRANCH_CODE");
            	String SECTION_CODE=rs.getString("SECTION_CODE");
            	String DEPT_CODE=rs.getString("DEPT_CODE");
            	String CATEGORY_CODE=rs.getString("CATEGORY_CODE");
            	double AMOUNT_PTD=rs.getDouble("AMOUNT_PTD");
            	double AMOUNT_REM=rs.getDouble("AMOUNT_REM");
            	String PART_PAY=rs.getString("PART_PAY");
            	String FULLY_PAID=rs.getString("FULLY_PAID");
            	int GROUP_ID=rs.getInt("GROUP_ID");
            	String BAR_CODE=rs.getString("BAR_CODE");
            	String SBU_CODE=rs.getString("SBU_CODE");
            	String LPO=rs.getString("LPO");
            	String supervisor=rs.getString("supervisor");

            	 app=new ComponentViewDetail(id,parentAssetId,parentCompId,assetId,
                     	category,description,serialNumber,make,model,additionalField,
                    	status,component,cost,assigned,depreciation,Registration_No,
                    	Branch_ID,Dept_ID,Section_id,Vendor_AC,Date_purchased,Dep_Rate,
                    	Asset_Engine_No,Supplier_Name,Asset_User,Asset_Maintenance,Accum_Dep,
                    	Monthly_Dep,Cost_Price,NBV,Dep_End_Date,Residual_Value,Authorized_By,
                    	Wh_Tax,Wh_Tax_Amount,Req_Redistribution,Posting_Date,Effective_Date,Purchase_Reason,Useful_Life,
                    	Total_Life,Location,Remaining_Life,Vatable_Cost,Vat,Req_Depreciation,
                    	Subject_TO_Vat,Who_TO_Rem,Email1,Who_To_Rem_2,Email2,Raise_Entry,
                    	Dep_Ytd,Section,State,Driver,Spare_2,User_ID,Date_Disposed,
                    	PROVINCE,Multiple,WAR_START_DATE,WAR_MONTH,WAR_EXPIRY_DATE,Last_Dep_Date,
                    	BRANCH_CODE,SECTION_CODE,DEPT_CODE,CATEGORY_CODE,AMOUNT_PTD,
                    	AMOUNT_REM,PART_PAY,FULLY_PAID,GROUP_ID,BAR_CODE,SBU_CODE,LPO,supervisor);
            	 collection.add(app);


            }

        } catch (Exception ex) {
            System.out.println("WARNING: cannot fetch AM_AD_COMPONENT->" +
                    ex.getMessage());
        } finally {
        	dbConnection.closeConnection(con, ps);
        }

        return collection;

    }




public String getAssetTransInfo(int tran_id){
   String query = "select process_status from am_asset_approval where transaction_id = "+tran_id;
   String result="";
    Connection con = null;
        PreparedStatement ps = null;
        ResultSet rs = null;

         



        try {
            con = dbConnection.getConnection("fixedasset");
            ps = con.prepareStatement(query);
            rs = ps.executeQuery();
            while (rs.next()) {
                result = rs.getString(1);

            }

        } catch (Exception ex) {
            System.out.println("AssetRecordsBean WARN: Error fetching getAssetTransInfo(int tran_id) ->" + ex);
        } finally {
            dbConnection.closeConnection(con, ps);
        }

        return result;


   } //getTransactionDetails()

public int getNumOfTransactionLevel(String levelCode){
   String query = "select level from approval_level_setup where code = '"+levelCode+"'";
   int result=100;
    Connection con = null;
        PreparedStatement ps = null;
        ResultSet rs = null;





        try {
            con = dbConnection.getConnection("fixedasset");
            ps = con.prepareStatement(query);
            rs = ps.executeQuery();
            while (rs.next()) {
                result = rs.getInt(1);

            }

        } catch (Exception ex) {
            System.out.println("AssetRecordsBean: getNumOfTransactionLevel(String levelCode) WARN: Error fetching CategoryCode ->" + ex);
        } finally {
            dbConnection.closeConnection(con, ps);
        }

        return result;


   } //getNumOfTransactionLevel()



public boolean updateNewAssetStatus(String assetId) throws Exception {

        String query = "update am_asset SET  asset_status = 'ACTIVE' where asset_id ='" +assetId+"'";
         boolean done = true;
        Connection con = null;
        PreparedStatement ps = null;

        try {



            con = dbConnection.getConnection("fixedasset");
            ps = con.prepareStatement(query);

            ps.execute();

        } catch (Exception ex) {
            done = false;
            System.out.println("AssetRecordsBean: updateNewAssetStatus: WARN:Error updating asset->" + ex);
        } finally {
            dbConnection.closeConnection(con, ps);
        }
        return done;

    }



public boolean updateNewApprovalAssetStatus(String assetId, int supervise) throws Exception {

        String query = "update am_asset_approval set  asset_status = ?, process_status=?, super_id =?, approval1 =? where asset_id =?";
         boolean done = true;
        Connection con = null;
        PreparedStatement ps = null;

        try {



            con = dbConnection.getConnection("fixedasset");
            ps = con.prepareStatement(query);
            ps.setString(1, "ACTIVE");
            ps.setString(2, "A");
            ps.setInt(3, supervise);
            ps.setInt(4, supervise);
            ps.setString(5,assetId);
            ps.execute();

        } catch (Exception ex) {
            done = false;
            System.out.println("AssetRecordsBean: updateNewAssetStatus: WARN:Error updating asset->" + ex);
        } finally {
            dbConnection.closeConnection(con, ps);
        }
        return done;

    }


public boolean insertComponent(String parentAssetId, String parentCompId,
            String category, String description, String serialNumber, String make, String model,
            String additionalField,String Componet,double cost,double assigned,double depreciation,
            String registration_no,String branch_id,String department_id,String section_id,String  vendor_account,
            String date_of_purchase,String  getDepreciationRate,String engine_number,String supplied_by,
            String user,String  maintained_by,int A,int B,String costPrice1,double costPrice2,String depreciation_end_date,
            String residual_value,String authorized_by,String wh_tax_cb,String wh_tax_amount,String require_depreciation,
            String depreciation_start_date,String reason,String C,String computeTotalLife,String location,String computeTotalLife2,
            String vatable_cost,String vat_amount,String require_redistribution,String subject_to_vat,String who_to_remind,
            String email_1,String who_to_remind_2,String email2,String raise_entry,String D,String section,String state,String driver,
            String spare_2,String user_id,String  province,String  multiple,String warrantyStartDate,int noOfMonths,String expiryDate,
            String getBranchCode,String getSectionCode,String getDeptCode,String getCategoryCode,String amountPTD,double  amountPTD2,
            String partPAY,String fullyPAID,String  group_id,String  bar_code,String sbu_code,String lpo,String getSupervisor ) throws Exception, Throwable
    {
    	String assetId = comp.createComponentAssetIdDelimiter(parentAssetId,description);
        Connection con = null;
        PreparedStatement ps = null;
        boolean done = true;


        if (make == null || make.equals("")) {
            make = "0";
        }
        if (maintained_by == null || maintained_by.equals("")) {
            maintained_by = "0";
        }
        if (supplied_by == null || supplied_by.equals("")) {
            supplied_by = "0";
        }
        if (user == null || user.equals("")) {
            user = "";
        }
        if (location == null || location.equals("")) {
            location = "0";
        }
        if (driver == null || driver.equals("")) {
            driver = "0";
        }
        if (state == null || state.equals("")) {
            state = "0";
        }
        if (department_id == null || department_id.equals("")) {
            department_id = "0";
        }
        if (vat_amount == null || vat_amount.equals("")) {
            vat_amount = "0.0";
        }
        if (vatable_cost == null || vatable_cost.equals("")) {
            vatable_cost = "0.0";
        }
        if (wh_tax_amount == null || wh_tax_amount.equals("")) {
            wh_tax_amount = "0";
        }
        if (branch_id == null || branch_id.equals("")) {
            branch_id = "0";
        }
        if (province == null || province.equals("")) {
            province = "0";
        }
        if (category_id == null || category_id.equals("")) {
            category_id = "0";
        }

        if (residual_value == null || residual_value.equals("")) {
            residual_value = "0";
        }
        if (section_id == null || section_id.equals("")) {
            section_id = "0";
        }


        if (warrantyStartDate == null || warrantyStartDate.equals("")) {
            warrantyStartDate = null;
        }
        if (expiryDate == null || expiryDate.equals("")) {
            expiryDate = null;
        }

        vat_amount = vat_amount.replaceAll(",", "");
        vatable_cost = vatable_cost.replaceAll(",", "");
        wh_tax_amount = wh_tax_amount.replaceAll(",", "");
        residual_value = residual_value.replaceAll(",", "");
        amountPTD = amountPTD.replaceAll(",","");



        String createQuery = "INSERT INTO AM_AD_COMPONENT ( PARENT_ASSET_ID,PARENT_COMP_ID ,ASSET_ID ,CATEGORY    " +
                             "  ,DESCRIPTION,SERIAL_NO,MAKE,MODEL ,ADDITIONAL_FIELD,STATUS,COMPONENT ,COST    " +
                             "  ,ASSIGNED,DEPRECIATION " +
                             "  ,Registration_No,Branch_ID,Dept_ID,Section_id,Vendor_AC    " +
                             " ,Date_purchased,Dep_Rate ,Asset_Engine_No ,Supplier_Name,Asset_User,Asset_Maintenance    " +
                             " ,Accum_Dep ,Monthly_Dep,Cost_Price ,NBV ,Dep_End_Date,Residual_Value ,Authorized_By    " +
                             " ,Wh_Tax   ,Wh_Tax_Amount  ,Req_Redistribution    " +
                             " ,Posting_Date  ,Effective_Date  ,Purchase_Reason ,Useful_Life ,Total_Life    " +
                             " ,Location  ,Remaining_Life  ,Vatable_Cost  ,Vat ,Req_Depreciation    " +
                             " ,Subject_TO_Vat   ,Who_TO_Rem  ,Email1 ,Who_To_Rem_2  ,Email2    " +
                             " ,Raise_Entry ,Dep_Ytd  ,Section  ,State ,Driver  ,Spare_2    " +
                             " ,User_ID  ,Date_Disposed ,PROVINCE ,Multiple  ,WAR_START_DATE    " +
                             " ,WAR_MONTH ,WAR_EXPIRY_DATE ,Last_Dep_Date ,BRANCH_CODE ,SECTION_CODE    " +
                             " ,DEPT_CODE ,CATEGORY_CODE  ,AMOUNT_PTD ,AMOUNT_REM  ,PART_PAY    " +
                             " ,FULLY_PAID  ,GROUP_ID ,BAR_CODE  ,SBU_CODE ,LPO ,supervisor ) " +
                             " VALUES(?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,  " +
                             " ?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?) ";
        try {
            double costPrice = Double.parseDouble(vat_amount) + Double.parseDouble(vatable_cost);
            int Accum_Dep = 0;//Integer.parseInt(String.valueOf(assigned));
            int Monthly_Dep=0;
            con = dbConnection.getConnection("fixedasset");
            ps = con.prepareStatement(createQuery);
            ps.setString(1, parentAssetId);
            ps.setInt(2, new Integer(parentCompId).intValue());
            ps.setString(3, assetId);
            ps.setInt(4, new Integer(category).intValue());
            ps.setString(5, description);
            ps.setString(6, serialNumber);
            ps.setString(7, make);
            ps.setString(8, model);
            ps.setString(9, additionalField);
            ps.setString(10, "ACTIVE");
            ps.setString(11, Componet);
            ps.setDouble(12, cost);
            ps.setDouble(13, assigned);
            ps.setDouble(14, depreciation);
            ps.setString(15, registration_no);
            ps.setInt(16, Integer.parseInt(branch_id));
            ps.setInt(17, Integer.parseInt(department_id));
            ps.setInt(18, Integer.parseInt(section_id));
            ps.setString(19, vendor_account);
            ps.setDate(20, dbConnection.dateConvert(date_of_purchase));

            ps.setString(21, getDepreciationRate(category));
            ps.setString(22, engine_number);
            ps.setInt(23, Integer.parseInt(supplied_by));
            ps.setString(24, user);
            ps.setInt(25, Integer.parseInt(maintained_by));
            ps.setInt(26, Accum_Dep);
            ps.setInt(27, Monthly_Dep);
            ps.setDouble(28, costPrice);
            ps.setDouble(29, costPrice);
            ps.setDate(30, dbConnection.dateConvert(depreciation_end_date));
            ps.setDouble(31, Double.parseDouble(residual_value));
            ps.setString(32, authorized_by);
            ps.setString(33, wh_tax_cb);
            ps.setDouble(34, Double.parseDouble(wh_tax_amount));
            ps.setString(35, require_depreciation);

            ps.setTimestamp(36, dbConnection.getDateTime(new java.util.Date()));
            ps.setDate(37, dbConnection.dateConvert(depreciation_start_date));
            ps.setString(38, reason);
            ps.setString(39, "0");
            ps.setString(40, computeTotalLife(getDepreciationRate(category)));
            ps.setInt(41, Integer.parseInt(location));
            ps.setString(42, computeTotalLife(getDepreciationRate(category)));
            ps.setDouble(43, Double.parseDouble(vatable_cost));
            ps.setDouble(44, Double.parseDouble(vat_amount));
            ps.setString(45, require_redistribution);
            ps.setString(46, subject_to_vat);
            ps.setString(47, who_to_remind);
            ps.setString(48, email_1);
            ps.setString(49, who_to_remind_2);
            ps.setString(50, email2);
            ps.setString(51, raise_entry);
            ps.setString(52, "0");
            ps.setString(53, section);
            ps.setInt(54, Integer.parseInt(state));
            ps.setInt(55, Integer.parseInt(driver));
            ps.setString(56, spare_2);
            ps.setString(57, user_id);
            ps.setTimestamp(58, dbConnection.getDateTime(new java.util.Date()));
            ps.setString(59, province);
            ps.setString(60, multiple);
            ps.setDate(61, dbConnection.dateConvert(warrantyStartDate));
            ps.setInt(62, new Integer(noOfMonths).intValue());
            ps.setDate(63, dbConnection.dateConvert(expiryDate));
            ps.setTimestamp(64, dbConnection.getDateTime(new java.util.Date()));
            ps.setString(65, code.getBranchCode(branch_id));
            ps.setString(66, code.getSectionCode(section_id));
            ps.setString(67, code.getDeptCode(department_id));
            ps.setString(68, code.getCategoryCode(category));
            ps.setDouble(69, Double.parseDouble(amountPTD));
            ps.setDouble(70, (costPrice-Double.parseDouble(amountPTD)));
            ps.setString(71, partPAY);
            ps.setString(72, fullyPAID);
            ps.setString(73, group_id);
            ps.setString(74, bar_code);
            ps.setString(75,sbu_code);
            ps.setString(76, lpo);
            ps.setString(77,getSupervisor);

            System.out.println("parent id "+parentAssetId);
            System.out.println("parent comp "+new Integer(parentCompId).intValue());
            System.out.println("asset id "+assetId);
            System.out.println("catergry "+new Integer(category).intValue());
            System.out.println("desc "+description);
            System.out.println("sn "+serialNumber);
            System.out.println("make "+make);
            System.out.println("model "+model);
            System.out.println("add field "+additionalField);
            System.out.println("ACTIVE");
            System.out.println("copnt "+Componet);
            System.out.println("cost "+cost);
            System.out.println("assign "+assigned);
            System.out.println("deprton "+depreciation);
            System.out.println("reg no "+registration_no);
            System.out.println("branch id "+Integer.parseInt(branch_id));
            System.out.println("dept id "+Integer.parseInt(department_id));
            System.out.println("sect id "+Integer.parseInt(section_id));
            System.out.println("vendor acc "+vendor_account);
            System.out.println("date purchsed "+dbConnection.dateConvert(date_of_purchase));
            System.out.println("dep rate "+getDepreciationRate(category));
            System.out.println("eng no "+engine_number);
            System.out.println("supply by "+Integer.parseInt(supplied_by));
            System.out.println("user "+user);
            System.out.println("mentaned by "+Integer.parseInt(maintained_by));
            System.out.println(0);
            System.out.println(0);
            System.out.println("cost p "+costPrice);
            System.out.println("cost "+costPrice);
            System.out.println("dep end date "+dbConnection.dateConvert(depreciation_end_date));
            System.out.println("res val "+Double.parseDouble(residual_value));
            System.out.println("auth by "+authorized_by);
            System.out.println("wh tax cb "+wh_tax_cb);
            System.out.println("wh tax amount "+Double.parseDouble(wh_tax_amount));
            System.out.println("req dep "+require_depreciation);
            System.out.println("date sample "+dbConnection.getDateTime(new java.util.Date()));
            System.out.println("dep start date "+dbConnection.dateConvert(depreciation_start_date));
            System.out.println("reacson "+reason);
            System.out.println("0");
            System.out.println("comtotal life "+computeTotalLife(getDepreciationRate(category)));
            System.out.println("location "+Integer.parseInt(location));
            System.out.println("comptolife "+computeTotalLife(getDepreciationRate(category)));
            System.out.println("vatable cost "+Double.parseDouble(vatable_cost));
            System.out.println("vat amount "+Double.parseDouble(vat_amount));
            System.out.println("req redistbuton "+require_redistribution);
            System.out.println("sub to vat "+subject_to_vat);
            System.out.println("wh to remind "+who_to_remind);
            System.out.println("email1 "+email_1);
            System.out.println("who to remind 2 "+who_to_remind_2);
            System.out.println("email2 "+email2);
            System.out.println("raise "+raise_entry);
            System.out.println("0");
            System.out.println("section "+section);
            System.out.println("state "+Integer.parseInt(state));
            System.out.println("driver "+Integer.parseInt(driver));
            System.out.println("spare 2 "+spare_2);
            System.out.println("usr id "+user_id);
            System.out.println("date "+dbConnection.getDateTime(new java.util.Date()));
            System.out.println("province "+province);
            System.out.println("multiple "+multiple);
            System.out.println("warantystate "+dbConnection.dateConvert(warrantyStartDate));
            System.out.println("month s "+new Integer(noOfMonths).intValue());
            System.out.println(dbConnection.dateConvert(expiryDate));
            System.out.println("date "+dbConnection.getDateTime(new java.util.Date()));
            System.out.println("get branch code "+code.getBranchCode(branch_id));
            System.out.println("get secton code "+code.getSectionCode(section_id));
            System.out.println("get dept code "+code.getDeptCode(department_id));
            System.out.println("get category code "+code.getCategoryCode(category));
            System.out.println("amtptd "+Double.parseDouble(amountPTD));
            System.out.println("amtptd 2 "+(costPrice-Double.parseDouble(amountPTD)));
            System.out.println("part pay "+partPAY);
            System.out.println("fullypaiod "+fullyPAID);
            System.out.println("group id "+group_id);
            System.out.println("bar code "+bar_code);
            System.out.println("sbu code "+sbu_code);
            System.out.println("lpo "+lpo);
            System.out.println("get supvsr "+getSupervisor);
            ps.execute();


        } catch (Exception ex) {
            done = false;
            System.out.println("WARN:Error creating asset->" + ex);
        } finally {
            dbConnection.closeConnection(con, ps);
        }

        return done;
    }


 public void updateComponentStatus(String parentAssetId,String description2,double cost)
    {
    	String query_r ="update AM_COMPONENT_DIST set created = ? where ASSET_ID=? AND COMPONENT_EXP_ACCT=? AND COST_VALUE=?  ";

    	        Connection con = null;
    	        PreparedStatement ps = null;
    	        //ResultSet rs = null;

    	try {
    	    con = dbConnection.getConnection("fixedasset");


    	ps = con.prepareStatement(query_r);



    	            ps.setString(1,"Y");
    	            ps.setString(2, parentAssetId);
    	            ps.setString(3,description2);
    	            ps.setDouble(4,cost);


    	            System.out.println("parentAssetId "+parentAssetId);
    	            System.out.println("description2 "+description2);
    	            System.out.println("cost "+cost);


    	            int i =ps.executeUpdate();


    	        } catch (Exception ex) {

    	            System.out.println("update not successful" + ex);
    	        } finally {
    	            dbConnection.closeConnection(con, ps);
    	        }


    	}

public String[] setApprovalDataUpdate(String id){

//String q ="select asset_id, asset_status,user_ID,supervisor,Cost_Price,Posting_Date,description,effective_date,BRANCH_CODE from am_asset where asset_id ='" +id+"'";
   String[] result= new String[12];
    Connection con = null;
        PreparedStatement ps = null;
        ResultSet rs = null;

         String query ="select asset_id,user_ID,supervisor,Cost_Price,Posting_Date,description,effective_date,BRANCH_CODE,Asset_Status from am_assetUpdate where asset_id ='" +id+"'"; ;



        try {
            con = dbConnection.getConnection("fixedasset");
            ps = con.prepareStatement(query);
            rs = ps.executeQuery();
            while (rs.next()) {
                result[0] = rs.getString(1);
                result[1]= rs.getString(2);
                result[2] = rs.getString(3);
               result[3] = rs.getString(4);
               result[4] = rs.getString(5);
               result[5] = rs.getString(6);
               result[6] = rs.getString(7);
               result[7] = rs.getString(8);
               result[8] = rs.getString(9);//asset_status

            }

        } catch (Exception ex) {
            System.out.println("WARN: Error fetching CategoryCode ->" + ex);
        } finally {
            dbConnection.closeConnection(con, ps);
        }
result[9] = "Asset Update";
result[10] = "P";

    System.out.println("the value of supervisor is *************setApprovalDataUpdate************************" + result[2]);
//result[11] = timeInstance();
        return result;

}//setApprovalData()


public boolean insertInToAssetRecordTemp(String assetId,String userId) throws Exception {

        String query = "insert into am_assetUpdate " +
                       "(REGISTRATION_NO,DESCRIPTION,VENDOR_AC," +
                       "DATE_PURCHASED,ASSET_MAKE,ASSET_MODEL," +
                       "ASSET_SERIAL_NO,ASSET_ENGINE_NO,SUPPLIER_NAME," +
                       "ASSET_USER,ASSET_MAINTENANCE,DEP_END_DATE," +
                       "RESIDUAL_VALUE,AUTHORIZED_BY,POSTING_DATE," +
                       "EFFECTIVE_DATE,PURCHASE_REASON,LOCATION," +
                       "WHO_TO_REM,EMAIL1,WHO_TO_REM_2," +
                       "EMAIL2,RAISE_ENTRY,SECTION,STATE,DRIVER," +
                       "SPARE_1 ,SPARE_2 ,ASSET_STATUS ,PROVINCE ," +
                       "DEPT_ID ,req_redistribution ,Req_Depreciation , " +
                       "SUBJECT_TO_VAT,VATABLE_COST,VAT ," +
                       "wh_tax ,wh_tax_amount ,BRANCH_ID ,MULTIPLE ,COST_PRICE," +
                       "BRANCH_CODE,DEPT_CODE,SECTION_CODE ,CATEGORY_CODE,WAR_START_DATE," +
                       "WAR_MONTH,WAR_EXPIRY_DATE, BAR_CODE ,SBU_CODE , LPO , supervisor, defer_pay ,asset_id,user_id,category_id,dep_rate)"+
                       "values(?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?)";

        Connection con = null;
        PreparedStatement ps = null;
        boolean done = true;
        /*if (require_redistribution.equalsIgnoreCase("Y")) {
            status = "Z";
                 }*/
        if (make == null || make.equals("")) {
            make = "0";
        }
        if (maintained_by == null || maintained_by.equals("")) {
            maintained_by = "0";
        }
        if (location == null || location.equals("")) {
            location = "0";
        }
        if (driver == null || driver.equals("")|| driver.equals("-1")) {
            driver = "0";
        }
        if (state == null || state.equals("")) {
            state = "0";
        }
        if (department_id == null || department_id.equals("")) {
            department_id = "0";
        }
        if (vat_amount == null || vat_amount.equals("")) {
            vat_amount = "0.0";
        }
        if (vatable_cost == null || vatable_cost.equals("")) {
            vatable_cost = "0.0";
        }
        if (wh_tax_amount == null || wh_tax_amount.equals("")) {
            wh_tax_amount = "0";
        }
        if (branch_id == null || branch_id.equals("")) {
            branch_id = "0";
        }
        if (residual_value == null || residual_value.equals("")) {
            residual_value = "0";
        }
        if (section_id == null || section_id.equals("")) {
            section_id = "0";
        }


        if (bar_code == null || bar_code.equals("")) {
            bar_code = "0";
        }

        if (sbu_code == null || sbu_code.equals("")) {
            sbu_code = "0";
        }

        if (lpo == null || lpo.equals("")) {
            lpo = "0";
        }

         if (depreciation_rate == null || depreciation_rate.equals("")) {
            depreciation_rate = "0";
        }

        vat_amount = vat_amount.replaceAll(",", "");
        vatable_cost = vatable_cost.replaceAll(",", "");
        wh_tax_amount = wh_tax_amount.replaceAll(",", "");
        residual_value = residual_value.replaceAll(",", "");

        try {

            double costPrice = Double.parseDouble(vat_amount) +
                               Double.parseDouble(vatable_cost);

            con = dbConnection.getConnection("fixedasset");
            ps = con.prepareStatement(query);
            ps.setString(1, registration_no);
            ps.setString(2, description);
            ps.setString(3, vendor_account);
            ps.setDate(4, dbConnection.dateConvert(date_of_purchase));
            ps.setInt(5, Integer.parseInt(make));
            ps.setString(6, model);
            ps.setString(7, serial_number);
            ps.setString(8, engine_number);
            ps.setString(9, supplied_by);
            ps.setString(10, user);
            ps.setInt(11, Integer.parseInt(maintained_by));
            ps.setDate(12, dbConnection.dateConvert(depreciation_end_date));
            ps.setDouble(13, Double.parseDouble(residual_value));
            ps.setString(14, authorized_by);
            ps.setDate(15, dbConnection.dateConvert(date_of_purchase));
            ps.setDate(16, dbConnection.dateConvert(depreciation_start_date));
            ps.setString(17, reason);
            ps.setInt(18, Integer.parseInt(location));
            ps.setString(19, who_to_remind);
            ps.setString(20, email_1);
            ps.setString(21, who_to_remind_2);
            ps.setString(22, email2);
            ps.setString(23, raise_entry);
            ps.setString(24, section);
            ps.setInt(25, Integer.parseInt(state));
            ps.setInt(26, Integer.parseInt(driver));
            ps.setString(27, spare_1);
            ps.setString(28, spare_2);
            ps.setString(29, status);
            ps.setString(30, province);
            ps.setInt(31, Integer.parseInt(department_id));
            ps.setString(32, require_redistribution);
            ps.setString(33, require_depreciation);
            ps.setString(34, subject_to_vat);
            ps.setDouble(35, Double.parseDouble(vatable_cost));
            ps.setDouble(36, Double.parseDouble(vat_amount));
            ps.setString(37, wh_tax_cb);
            ps.setDouble(38, Double.parseDouble(wh_tax_amount));
            ps.setInt(39, Integer.parseInt(branch_id));
            ps.setString(40, multiple);
            ps.setDouble(41, costPrice);
            ps.setString(42, code.getBranchCode(branch_id));
            ps.setString(43, code.getDeptCode(department_id));
            ps.setString(44, code.getSectionCode(section_id));
            ps.setString(45, code.getCategoryCode(category_id));
            ps.setDate(46, dbConnection.dateConvert(warrantyStartDate));
            ps.setInt(47, Integer.parseInt(noOfMonths));
            ps.setDate(48, dbConnection.dateConvert(expiryDate));
            ps.setString(49, bar_code);
            ps.setString(50,sbu_code);
            ps.setString(51, lpo);
            ps.setString(52,getSupervisor());
            ps.setString(53,deferPay);
            ps.setString(54, assetId);
            ps.setString(55,userId);
            ps.setString(56, category_id);
            ps.setString(57, depreciation_rate);
            ps.execute();

        } catch (Exception ex) {
            done = false;
            System.out.println("AssetRecordsBean: insertInToAssetRecordTemp():WARN:Error inserting to am_assetUpdate table->" + ex);
        } finally {
            dbConnection.closeConnection(con, ps);
        }
        return done;

    }

 public void getAssetRecordsForApproval(String assetId, String update_changes) throws Exception {

        if (!(assetId.equalsIgnoreCase(""))) {
            String query = "SELECT A.ASSET_ID, A.REGISTRATION_NO," +
                           "A.BRANCH_ID, A.DEPT_ID, A.CATEGORY_ID,A.SECTION, A.DESCRIPTION," +
                           "A.VENDOR_AC, A.DATE_PURCHASED," +
                           "A.DEP_RATE, A.ASSET_MAKE, A.ASSET_MODEL, A.ASSET_SERIAL_NO, A.ASSET_ENGINE_NO," +
                           "A.SUPPLIER_NAME, A.ASSET_USER, A.ASSET_MAINTENANCE, A.ACCUM_DEP, A.MONTHLY_DEP," +
                           "A.COST_PRICE, A.NBV,A.STATE,A.DRIVER,A.WH_TAX,A.WH_TAX_AMOUNT," +
                           "DEP_END_DATE, A.RESIDUAL_VALUE, A.AUTHORIZED_BY, A.POSTING_DATE,A.EFFECTIVE_DATE," +
                           "A.PURCHASE_REASON, A.USEFUL_LIFE, A.TOTAL_LIFE, A.LOCATION," +
                           "A.REMAINING_LIFE, A.VATABLE_COST, A.VAT, A.REQ_DEPRECIATION," +
                           "A.SUBJECT_TO_VAT, A.WHO_TO_REM, A.EMAIL1, A.EMAIL2," +
                           "A.RAISE_ENTRY, A.DEP_YTD, A.SECTION_ID, A.ASSET_STATUS," +
                           "A.VENDOR_AC,A.SPARE_1,A.SPARE_2,A.REQ_REDISTRIBUTION,A.DATE_DISPOSED," +
                           "A.[USER_ID], A.WHO_TO_REM_2,A.MULTIPLE,A.WAR_START_DATE,WAR_MONTH,WAR_EXPIRY_DATE," +
                           "AMOUNT_PTD,AMOUNT_REM,PART_PAY,FULLY_PAID, GROUP_ID,A.BAR_CODE,A.SBU_CODE,A.LPO,A.SUPERVISOR,A.defer_pay " +
                           "FROM AM_ASSETUPDATE A " +
                           "WHERE A.ASSET_ID = '" + assetId + "'";

            Connection con = null;
            PreparedStatement ps = null;
            ResultSet rs = null;

            try {
                con = dbConnection.getConnection("fixedasset");
                ps = con.prepareStatement(query);
                rs = ps.executeQuery();

                if (rs.next()) {

                    registration_no = rs.getString("REGISTRATION_NO");
                    branch_id = rs.getString("BRANCH_ID");
                    department_id = rs.getString("DEPT_ID");
                    category_id = rs.getString("CATEGORY_ID");
                    depreciation_start_date = dbConnection.formatDate(rs.
                            getDate("EFFECTIVE_DATE"));
                    depreciation_end_date = dbConnection.formatDate(rs.getDate(
                            "DEP_END_DATE"));
                    posting_date = dbConnection.formatDate(rs.getDate(
                            "DATE_PURCHASED"));
                    make = rs.getString("ASSET_MAKE");
                    location = rs.getString("LOCATION");
                    maintained_by = rs.getString("ASSET_MAINTENANCE");
                    accum_dep = rs.getDouble("ACCUM_DEP");
                    authorized_by = rs.getString("AUTHORIZED_BY");
                    supplied_by = rs.getString("SUPPLIER_NAME");
                    reason = rs.getString("PURCHASE_REASON");
                    asset_id = rs.getString("ASSET_ID");
                    description = rs.getString("DESCRIPTION");
                    vendor_account = rs.getString("VENDOR_AC");
                    cost_price = rs.getString("COST_PRICE");
                    vatable_cost = rs.getString("VATABLE_COST");
                    vat_amount = rs.getString("VAT");
                    serial_number = rs.getString("ASSET_SERIAL_NO");
                    model = rs.getString("ASSET_MODEL");
                    user = rs.getString("USER_ID");
                    depreciation_rate = rs.getString("DEP_RATE");
                    residual_value = rs.getString("RESIDUAL_VALUE");
                    require_depreciation = rs.getString("REQ_DEPRECIATION");
                    subject_to_vat = rs.getString("SUBJECT_TO_VAT");
                    date_of_purchase = dbConnection.formatDate(rs.getDate(
                            "DATE_PURCHASED"));
                    who_to_remind = rs.getString("WHO_TO_REM");
                    email_1 = rs.getString("EMAIL1");
                    email2 = rs.getString("EMAIL2");
                    raise_entry = rs.getString("RAISE_ENTRY");
                    section = rs.getString("SECTION_ID");
                    accum_dep = rs.getDouble("ACCUM_DEP");
                    status = rs.getString("ASSET_STATUS");
                    section_id = rs.getString("SECTION");
                    wh_tax_cb = rs.getString("WH_TAX");
                    wh_tax_amount = rs.getString("WH_TAX_AMOUNT");
                    require_redistribution = rs.getString("REQ_REDISTRIBUTION");
                    spare_1 = rs.getString("SPARE_1");
                    spare_2 = rs.getString("SPARE_2");
                    who_to_remind_2 = rs.getString("WHO_TO_REM_2");
                    driver = rs.getString("DRIVER");
                    state = rs.getString("STATE");
                    engine_number = rs.getString("ASSET_ENGINE_NO");
                    multiple = rs.getString("MULTIPLE");
                    posting_date = dbConnection.formatDate(rs.getDate(
                            "POSTING_DATE"));
                    warrantyStartDate = dbConnection.formatDate(rs.getDate(
                            "WAR_START_DATE"));
                    noOfMonths = rs.getString("WAR_MONTH");
                    expiryDate = dbConnection.formatDate(rs.getDate(
                            "WAR_EXPIRY_DATE"));
                    authuser = rs.getString("ASSET_USER");
                    amountPTD =String.valueOf(rs.getDouble("AMOUNT_PTD"));
                    amountREM =String.valueOf(rs.getDouble("AMOUNT_REM"));
                    partPAY = rs.getString("PART_PAY");
                    fullyPAID =rs.getString("FULLY_PAID");
                    group_id =rs.getString("GROUP_ID");
                    bar_code = rs.getString("BAR_CODE");
                    sbu_code = rs.getString("SBU_CODE");
                    lpo = rs.getString("LPO");
                    setSupervisor(rs.getString("SUPERVISOR"));
                    deferPay = rs.getString("defer_pay");

                } else {
                    System.out.print("nothing");
                }//else

                if(update_changes.equalsIgnoreCase("YES")){

                    String updateQuery = "UPDATE am_asset SET REGISTRATION_NO = ?," +
         "ASSET_MAINTENANCE = ?, AUTHORIZED_BY = ? , SUPPLIER_NAME = ?, PURCHASE_REASON = ?,"+
          "DESCRIPTION = ?, VENDOR_AC = ? , ASSET_SERIAL_NO = ?, ASSET_MODEL = ?,"+
          "USER_ID = ?, SUBJECT_TO_VAT = ? , WHO_TO_REM = ?, EMAIL1 = ?,"+
          "EMAIL2 = ?, WH_TAX = ? , SPARE_1 = ?, SPARE_2 = ?,"+
          "WHO_TO_REM_2 = ?, DRIVER = ? , ASSET_ENGINE_NO = ?, WAR_MONTH = ?,"+
          "BAR_CODE = ?, LPO = ? WHERE ASSET_ID = ?";

          ps = con.prepareStatement(updateQuery);
                    ps.setString(1, registration_no);
                    ps.setString(2, maintained_by);
                    ps.setString(3, authorized_by);
                    ps.setString(4, supplied_by);
                    ps.setString(5, reason);
                    ps.setString(6, description);
                    ps.setString(7, vendor_account);
                    ps.setString(8, serial_number);
                    ps.setString(9, model);
                    ps.setString(10, user);
                    ps.setString(11, subject_to_vat);
                    ps.setString(12, who_to_remind);
                    ps.setString(13, email_1);
                    ps.setString(14, email2);
                    ps.setString(15, wh_tax_cb);
                    ps.setString(16, spare_1);
                    ps.setString(17, spare_2);
                    ps.setString(18, who_to_remind_2);
                    ps.setString(19, driver);
                    ps.setString(20, engine_number);
                    ps.setString(21, noOfMonths);
                    ps.setString(22, bar_code);
                    ps.setString(23, lpo);
                    ps.setString(24, asset_id);

                int i =ps.executeUpdate();


                }//if(update_changes.equalsIgnoreCase("YES"))


            } catch (Exception ex) {
                System.out.println("AssetRecordsBean: getAssetRecordsForApproval()WARN: Error fetching all asset/ updating am_assetUpdate table ->" + ex);
            } finally {
                dbConnection.closeConnection(con, ps,rs);
            }
        }
    }


public void updateComponentStatus(String parentAssetId,String description2,double cost,String DepSeqValue)
    {
    	String query_r ="update AM_COMPONENT_DIST set created = ? where ASSET_ID=? AND COMPONENT_EXP_ACCT=? AND COST_VALUE=? AND SEQUENCE_NO=? ";

    	        Connection con = null;
    	        PreparedStatement ps = null;
    	        //ResultSet rs = null;

    	try {
    	    con = dbConnection.getConnection("fixedasset");


    	ps = con.prepareStatement(query_r);



    	            ps.setString(1,"Y");
    	            ps.setString(2, parentAssetId);
    	            ps.setString(3,description2);
    	            ps.setDouble(4,cost);
    	            ps.setString(5, DepSeqValue);


    	            System.out.println("parentAssetId "+parentAssetId);
    	            System.out.println("description2 "+description2);
    	            System.out.println("cost "+cost);


    	            int i =ps.executeUpdate();


    	        } catch (Exception ex) {

    	            System.out.println("update not successful" + ex);
    	        } finally {
    	            dbConnection.closeConnection(con, ps);
    	        }


    	}

public int changeAssetID(String oldAssetId,String newAssetId)
    {
    int value =0;

    String query_r ="update am_asset set asset_id = ? where ASSET_ID=? ";

    	        Connection con = null;
    	        PreparedStatement ps = null;
    	        //ResultSet rs = null;

    	try {
    	    con = dbConnection.getConnection("fixedasset");


    	ps = con.prepareStatement(query_r);



    	            ps.setString(1,newAssetId);
    	            ps.setString(2, oldAssetId);

    	            value =ps.executeUpdate();


    	        } catch (Exception ex) {

    	            System.out.println("AssetRecordsBean: changeAssetID(): asset id update not successful" + ex);
    	        } finally {
    	            dbConnection.closeConnection(con, ps);
    	        }

return value;
    	}



public String setPendingTrans2(String[] a, String code){

    String mtid_id ="";
        int transaction_level=0;
        Connection con;
        PreparedStatement ps;
        ResultSet rs;
 String pq = "insert into am_asset_approval(asset_id,user_id,super_id,amount,posting_date,description,effective_date,branchCode,asset_status,tran_type, process_status,tran_sent_time,transaction_id,batch_id,transaction_level) values(?,?,?,?,?,?,?,?,?,?,?,?,?,?,?)";
 String tranLevelQuery = "select level from approval_level_setup where code ='"+code+"'";
        con = null;
        ps = null;
        rs = null;
        try
        {
            con = dbConnection.getConnection("fixedasset");


            /////////////To get transaction level
             ps = con.prepareStatement(tranLevelQuery);
              rs = ps.executeQuery();


            while(rs.next()){
            transaction_level = rs.getInt(1);

            }//if



            ////////////To set values for approval table

            ps = con.prepareStatement(pq);


            SimpleDateFormat timer = new SimpleDateFormat("kk:mm:ss");

            String mtid =  new ApplicationHelper().getGeneratedId("am_asset_approval");
            ps.setString(1, (a[0]==null)?"":a[0]);
            ps.setString(2, (a[1]==null)?"":a[1]);
            ps.setString(3, (a[2]==null)?"":a[2]);
            ps.setDouble(4, (a[3]==null)?0:Double.parseDouble(a[3]));
            ps.setDate(5, (a[4])==null?null:dbConnection.dateConvert(a[4]));
            ps.setString(6, (a[5]==null)?"":a[5]);
            ps.setDate(7,(a[6])==null?null:dbConnection.dateConvert(a[6]));
            ps.setString(8, (a[7]==null)?"":a[7]);
            ps.setString(9, (a[8]==null)?"":a[8]); //asset_status
            ps.setString(10, (a[9]==null)?"":a[9]);
            ps.setString(11, a[10]);
            ps.setString(12, timer.format(new java.util.Date()));
            ps.setString(13,mtid);
            ps.setString(14, mtid);
            ps.setInt(15, transaction_level);

            ps.execute();

            mtid_id = mtid;
        }
        catch(Exception er)
        {
            System.out.println(">>>AssetRecordBeans:setPendingTrans(>>>>>>" + er);

        }finally{
        dbConnection.closeConnection(con, ps);

        }

   //String pq = "insert into am_asset_approval(asset_id,user_id,super_id,amount,posting_date,description,effective_date,branchCode,tran_type, process_status,tran_sent_time) values(?,?,?,?,?,?,?,?,?,?,?)";



return mtid_id;


    }//setPendingTrans2()

public void updateGroupAssetStatus(String assetId){
String query_r ="update am_group_asset set asset_status=?,raise_entry=? where asset_id = '"+assetId+"'";

Connection con = null;
        PreparedStatement ps = null;
        //ResultSet rs = null;

try {
    con = dbConnection.getConnection("fixedasset");


ps = con.prepareStatement(query_r);



            ps.setString(1,"ACTIVE");
            ps.setString(2,"Y");
            //ps.setString(2,reject_reason);
           int i =ps.executeUpdate();
            //ps.execute();

        } catch (Exception ex) {

            System.out.println("AssetRecordBean: updateAssetStatus()>>>>>" + ex);
        } finally {
            dbConnection.closeConnection(con, ps);
        }


}//updateAssetStatus()

//lanre update asset with asset_id and user_id
public boolean updateAsset(String assetId,String userId) throws Exception {

    String query = "update am_asset set " +
                   "REGISTRATION_NO=?,DESCRIPTION=?,VENDOR_AC=?," +
                   "DATE_PURCHASED=?,ASSET_MAKE=?,ASSET_MODEL=?," +
                   "ASSET_SERIAL_NO=?,ASSET_ENGINE_NO=?,SUPPLIER_NAME=?," +
                   "ASSET_USER=?,ASSET_MAINTENANCE=?,DEP_END_DATE=?," +
                   "RESIDUAL_VALUE=?,AUTHORIZED_BY=?,POSTING_DATE=?," +
                   "EFFECTIVE_DATE=?,PURCHASE_REASON=?,LOCATION=?," +
                   "WHO_TO_REM=?,EMAIL1=?,WHO_TO_REM_2=?," +
                   "EMAIL2=?,RAISE_ENTRY=?,SECTION=?,STATE=?,DRIVER=?," +
                   "SPARE_1=? ,SPARE_2=? ,ASSET_STATUS=? ,PROVINCE=? ," +
                   "DEPT_ID=? ,req_redistribution=? ,Req_Depreciation=? , " +
                   "SUBJECT_TO_VAT=?,VATABLE_COST=?,VAT=? ," +
                   "wh_tax=? ,wh_tax_amount=? ,BRANCH_ID=? ,MULTIPLE=? ,COST_PRICE=?," +
                   "BRANCH_CODE=?,DEPT_CODE=?,SECTION_CODE=? ,CATEGORY_CODE=?,WAR_START_DATE=?," +
                   "WAR_MONTH=?,WAR_EXPIRY_DATE=?, BAR_CODE=? ,SBU_CODE=? , LPO=? , supervisor=?, defer_pay=? ,category_id=?,dep_rate=? where asset_id=? and user_id=? " ;

    Connection con = null;
    PreparedStatement ps = null;
    boolean done = true;
    /*if (require_redistribution.equalsIgnoreCase("Y")) {
        status = "Z";
             }*/
    if (make == null || make.equals("")) {
        make = "0";
    }
    if (maintained_by == null || maintained_by.equals("")) {
        maintained_by = "0";
    }
    if (location == null || location.equals("")) {
        location = "0";
    }
    if (driver == null || driver.equals("")|| driver.equals("-1")) {
        driver = "0";
    }
    if (state == null || state.equals("")) {
        state = "0";
    }
    if (department_id == null || department_id.equals("")) {
        department_id = "0";
    }
    if (vat_amount == null || vat_amount.equals("")) {
        vat_amount = "0.0";
    }
    if (vatable_cost == null || vatable_cost.equals("")) {
        vatable_cost = "0.0";
    }
    if (wh_tax_amount == null || wh_tax_amount.equals("")) {
        wh_tax_amount = "0";
    }
    if (branch_id == null || branch_id.equals("")) {
        branch_id = "0";
    }
    if (residual_value == null || residual_value.equals("")) {
        residual_value = "0";
    }
    if (section_id == null || section_id.equals("")) {
        section_id = "0";
    }


    if (bar_code == null || bar_code.equals("")) {
        bar_code = "0";
    }

    if (sbu_code == null || sbu_code.equals("")) {
        sbu_code = "0";
    }

    if (lpo == null || lpo.equals("")) {
        lpo = "0";
    }

     if (depreciation_rate == null || depreciation_rate.equals("")) {
        depreciation_rate = "0";
    }

    vat_amount = vat_amount.replaceAll(",", "");
    vatable_cost = vatable_cost.replaceAll(",", "");
    wh_tax_amount = wh_tax_amount.replaceAll(",", "");
    residual_value = residual_value.replaceAll(",", "");

    try {

        double costPrice = Double.parseDouble(vat_amount) +
                           Double.parseDouble(vatable_cost);
System.out.println("vatable_cost "+vatable_cost);
        con = dbConnection.getConnection("fixedasset");
        ps = con.prepareStatement(query);
        ps.setString(1, registration_no);
        ps.setString(2, description);
        ps.setString(3, vendor_account);
        ps.setDate(4, dbConnection.dateConvert(date_of_purchase));
        ps.setInt(5, Integer.parseInt(make));
        ps.setString(6, model);
        ps.setString(7, serial_number);
        ps.setString(8, engine_number);
        ps.setString(9, supplied_by);
        ps.setString(10, user);
        ps.setInt(11, Integer.parseInt(maintained_by));
        ps.setDate(12, dbConnection.dateConvert(depreciation_end_date));
        ps.setDouble(13, Double.parseDouble(residual_value));
        ps.setString(14, authorized_by);
        ps.setDate(15, dbConnection.dateConvert(date_of_purchase));
        ps.setDate(16, dbConnection.dateConvert(depreciation_start_date));
        ps.setString(17, reason);
        ps.setInt(18, Integer.parseInt(location));
        ps.setString(19, who_to_remind);
        ps.setString(20, email_1);
        ps.setString(21, who_to_remind_2);
        ps.setString(22, email2);
        ps.setString(23, raise_entry);
        ps.setString(24, section);
        ps.setInt(25, Integer.parseInt(state));
        ps.setInt(26, Integer.parseInt(driver));
        ps.setString(27, spare_1);
        ps.setString(28, spare_2);
        ps.setString(29, status);
        ps.setString(30, province);
        ps.setInt(31, Integer.parseInt(department_id));
        ps.setString(32, require_redistribution);
        ps.setString(33, require_depreciation);
        ps.setString(34, subject_to_vat);
        ps.setDouble(35, Double.parseDouble(vatable_cost));
        ps.setDouble(36, Double.parseDouble(vat_amount));
        ps.setString(37, wh_tax_cb);
        ps.setDouble(38, Double.parseDouble(wh_tax_amount));
        ps.setInt(39, Integer.parseInt(branch_id));
        ps.setString(40, multiple);
        ps.setDouble(41, costPrice);
        ps.setString(42, code.getBranchCode(branch_id));
        ps.setString(43, code.getDeptCode(department_id));
        ps.setString(44, code.getSectionCode(section_id));
        ps.setString(45, code.getCategoryCode(category_id));
        ps.setDate(46, dbConnection.dateConvert(warrantyStartDate));
        ps.setInt(47, Integer.parseInt(noOfMonths));
        ps.setDate(48, dbConnection.dateConvert(expiryDate));
        ps.setString(49, bar_code);
        ps.setString(50,sbu_code);
        ps.setString(51, lpo);
        ps.setString(52,getSupervisor());
        ps.setString(53,deferPay);

        ps.setString(54, category_id);
        ps.setString(55, depreciation_rate);


        ps.setString(56, assetId);
        ps.setString(57,userId);
        ps.execute();

    } catch (Exception ex) {
        done = false;
        System.out.println("AssetRecordsBean: updateasset():WARN:Error updating to am_asset table->" + ex);
    } finally {
        dbConnection.closeConnection(con, ps);
    }
    return done;

}

 /**
     * *Bulk asset update
     */
    public boolean bulkAssetUpdate(java.util.ArrayList list) {
	/*String query = "UPDATE AM_ASSET SET DESCRIPTION=? "
		+",DATE_PURCHASED= ?, COST_PRICE = ?"
			+ " WHERE ASSET_ID=?";*/

    /*String query = "update am_asset SET  " +
                       "REGISTRATION_NO=?,VENDOR_AC=?," +
                       "ASSET_MODEL=?,ASSET_SERIAL_NO=?," +
                       "ASSET_ENGINE_NO=?,SUPPLIER_NAME=?," +
                       "ASSET_USER=?,ASSET_MAINTENANCE=?," +
                       "AUTHORIZED_BY=?," +
                       "PURCHASE_REASON=?," +
                       "SPARE_1 = ?,SPARE_2 = ?," +
                       "BAR_CODE =?,LPO =? " +
                       "WHERE ASSET_ID =? ";*/

     String query = "update am_asset SET  " +
                       "REGISTRATION_NO=?,VENDOR_AC=?," +
                       "ASSET_MODEL=?,ASSET_SERIAL_NO=?," +
                       "ASSET_ENGINE_NO=?,SUPPLIER_NAME=?," +
                       "ASSET_USER=?,ASSET_MAINTENANCE=?," +
                       "AUTHORIZED_BY=?," +
                       "PURCHASE_REASON=?," +
                       "SPARE_1 = ?,SPARE_2 = ?," +
                       "BAR_CODE =? " +
                       "WHERE ASSET_ID =? ";

     System.out.println("*********Scream VIIIIIICCCCKKIIIIEEEEEEE from BACK************ got into the mettod");
	Connection con = null;
	PreparedStatement ps = null;
	ResultSet rs = null;
	magma.AssetRecordsBean bd = null;
	int[] d = null;
	try {
		con = getConnection();
		ps = con.prepareStatement(query);

		for (int i = 0; i < list.size(); i++) {
			bd = (magma.AssetRecordsBean) list.get(i);

            String registration = bd.getRegistration_no();
			String vendoracc = bd.getVendor_account();
			String model1 = bd.getModel();
			String serial = bd.getSerial_number();
            String engine = bd.getEngine_number();
            String suppliedby = bd.getSupplied_by();
            String assetuser = bd.getUser();
            Integer maintained = Integer.parseInt(bd.getMaintained_by());
            String authorized = bd.getAuthorized_by();
            String reason1 = bd.getReason();
            String spare1 = bd.getSpare_1();
            String spare2 = bd.getSpare_2();
            String barcode = bd.getBar_code();
            String lpo1 = bd.getLpo();
            String asset_id1 = bd.getAsset_id();


            if (registration == null || registration.equals("")) {
                registration = "0";
            }
            if (vendoracc == null || vendoracc.equals("")) {
                vendoracc = "0";
            }
            if (model1 == null || model1.equals("")) {
                model1 = "0";
            }
            if (serial == null || serial.equals("")) {
                serial = "0";
            }
            if (engine == null || engine.equals("")) {
                engine = "0";
            }
            if (suppliedby == null || suppliedby.equals("")) {
                suppliedby = "0";
            }
            if (assetuser == null || assetuser.equals("")) {
                assetuser = "0";
            }
            if (maintained == null) {
                maintained = 0;
            }
            if (authorized == null || authorized.equals("")) {
                authorized = "0";
            }
            if (reason1 == null || reason1.equals("")) {
                reason1 = "0";
            }
            if (spare1 == null || spare1.equals("")) {
                spare1 = "0";
            }
            if (spare2 == null || spare2.equals("")) {
                spare2 = "0";
            }
           if (asset_id1 == null || asset_id1.equals("")) {
                asset_id1 = "0";
            }
            if (barcode == null || barcode.equals("")) {
                barcode = "0";
            }
            if (lpo1 == null || lpo1.equals("")) {
            lpo1 = "0";
            }

            ps.setString(1, registration);
			ps.setString(2, vendoracc);
			ps.setString(3, model1);
			ps.setString(4, serial);
            ps.setString(5, engine);
            ps.setString(6, suppliedby);
            ps.setString(7, assetuser);
            ps.setInt(8, maintained);
            ps.setString(9, authorized);
            ps.setString(10, reason1);
            ps.setString(11, spare1);
            ps.setString(12, spare2 );
            ps.setString(13, barcode);
           // ps.setString(14, lpo1);
            ps.setString(14, asset_id1);

            //-------
			/*ps.setString(1, bd.getRegistration_no());
			ps.setString(2, bd.getVendor_account());
			ps.setString(3, bd.getModel());
			ps.setString(4, bd.getSerial_number());
            ps.setString(5, bd.getEngine_number());
            ps.setString(6, bd.getSupplied_by());
            ps.setString(7, bd.getUser());
            ps.setInt(8, Integer.parseInt(bd.getMaintained_by()));
            ps.setString(9, bd.getAuthorized_by());
            ps.setString(10, bd.getReason());
            ps.setString(11, bd.getSpare_1());
            ps.setString(12, bd.getSpare_2());
            ps.setString(13, bd.getBar_code());
            ps.setString(14, bd.getLpo());
            ps.setString(15, bd.getAsset_id());*/

            System.out.println("*********Scream VIIIIIICCCCKKIIIIEEEEEEE from BACK************ before printing");
			System.out.println(registration);
			System.out.println(vendoracc);
			System.out.println(model1);
            System.out.println(serial);
            System.out.println(engine);
            System.out.println(suppliedby);
            System.out.println(assetuser);
            System.out.println(maintained);
            System.out.println(authorized);
            System.out.println(reason1);
            System.out.println(spare1);
            System.out.println(spare2);
            System.out.println(lpo1);
            System.out.println(barcode);
            System.out.println(asset_id1);
            //System.out.println("*********Scream VIIIIIICCCCKKIIIIEEEEEEE from BACK************"+ bd.getModel() + "" + );

            System.out.println("*********Scream VIIIIIICCCCKKIIIIEEEEEEE from BACK************ before adding batch");
			ps.addBatch();
		}
		d = ps.executeBatch();

	} catch (Exception ex) {
		System.out.println("Error Updating all asset ->" + ex);
	} finally {
		closeConnection(con, ps);
	}
	return (d.length > 0);
}

    /**
     * Closing connection for prepared statements
     * @param con
     * @param ps
     */
    private void closeConnection(Connection con, PreparedStatement ps) {
		try {
			if (ps != null) {
				ps.close();
			}
			if (con != null) {
				con.close();
			}
		} catch (Exception e) {
			System.out.println("WARNING: Error closing connection ->"
					+ e.getMessage());
		}

	}
public boolean updateStatus(String status,String batchId) throws Exception {

    String query = "update am_asset_approval set PROCESS_STATUS=? where BATCH_ID=? " ;

    Connection con = null;
    PreparedStatement ps = null;
    boolean done = true;
    try {
        con = dbConnection.getConnection("fixedasset");
        ps = con.prepareStatement(query);
        ps.setString(1, status);
        ps.setString(2, batchId);

        ps.execute();

    } catch (Exception ex) {
        done = false;
        System.out.println("am_asset_approval: update am_asset_approval():WARN:Error updating to am_asset_approval table->" + ex);
    } finally {
        dbConnection.closeConnection(con, ps);
    }
    return done;
}



private String getCurrentDate1(){
   String output = null;

 try {
        SimpleDateFormat sdf1 = new SimpleDateFormat("dd-MM-yyyy");
Date date = new Date();
   output = sdf1.format(date);
//output = sdf.parse(sdf.format(date));
     System.out.println("the pre output is " + sdf1.toPattern());
}catch(Exception e){e.printStackTrace();}

return output;


    }


}
